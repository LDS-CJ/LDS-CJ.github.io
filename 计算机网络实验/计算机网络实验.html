<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



</style><title>计算机网络实验</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h2 id='h1-align--center计算机网络实验h1'><span>            </span><h1 align = "center"><code>计算机网络实验</code></h1><span> </span></h2><p>&nbsp;</p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n0"><a class="md-toc-inner" href="#h1-align--center计算机网络实验h1">            <code>计算机网络实验</code> </a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n2"><a class="md-toc-inner" href="#验证性实验">验证性实验</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n3"><a class="md-toc-inner" href="#实验一">实验一</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n4"><a class="md-toc-inner" href="#ipconfig">Ipconfig</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n6"><a class="md-toc-inner" href="#常用命令-1">常用命令</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n19"><a class="md-toc-inner" href="#实作一-1">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n22"><a class="md-toc-inner" href="#实作二-1">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n25"><a class="md-toc-inner" href="#实验二">实验二</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n27"><a class="md-toc-inner" href="#ping">ping</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n29"><a class="md-toc-inner" href="#常用命令-2">常用命令</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n32"><a class="md-toc-inner" href="#实作一-2">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n37"><a class="md-toc-inner" href="#实作二-2">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n40"><a class="md-toc-inner" href="#1使用-ping--t">1.使用 ping -t</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n44"><a class="md-toc-inner" href="#2使用ping--a">2.使用ping -a</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n48"><a class="md-toc-inner" href="#3使用ping--n">3.使用ping -n</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n50"><a class="md-toc-inner" href="#4使用ping-i-size">4.使用ping-I size</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n53"><a class="md-toc-inner" href="#6使用ping-r-count">6.使用ping-r count</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n56"><a class="md-toc-inner" href="#7其他ping-问题">7.其他ping 问题</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n59"><a class="md-toc-inner" href="#实验三">实验三</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n60"><a class="md-toc-inner" href="#tracert">tracert</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n62"><a class="md-toc-inner" href="#常用命令-3">常用命令</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n64"><a class="md-toc-inner" href="#实作一-3">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n67"><a class="md-toc-inner" href="#实作二-3">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n79"><a class="md-toc-inner" href="#实验四">实验四</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n80"><a class="md-toc-inner" href="#arp">ARP</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n82"><a class="md-toc-inner" href="#常用命令-4">常用命令</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n84"><a class="md-toc-inner" href="#实作一-4">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n89"><a class="md-toc-inner" href="#实作二-4">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n92"><a class="md-toc-inner" href="#实作三-1">实作三</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n96"><a class="md-toc-inner" href="#问题一-1">问题一</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n99"><a class="md-toc-inner" href="#问题二-1"><strong>问题二</strong></a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n103"><a class="md-toc-inner" href="#实验五">实验五</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n104"><a class="md-toc-inner" href="#dhcp">DHCP</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n107"><a class="md-toc-inner" href="#实作一-5">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n110"><a class="md-toc-inner" href="#问题-1">问题</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n113"><a class="md-toc-inner" href="#秘籍">秘籍</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n117"><a class="md-toc-inner" href="#实验六">实验六</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n118"><a class="md-toc-inner" href="#netstat">netstat</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n121"><a class="md-toc-inner" href="#重用命令">重用命令</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n124"><a class="md-toc-inner" href="#实作一-6">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n127"><a class="md-toc-inner" href="#实作二-5">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n130"><a class="md-toc-inner" href="#实验七">实验七</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n131"><a class="md-toc-inner" href="#dns">DNS</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n133"><a class="md-toc-inner" href="#nslookup常用命令">nslookup常用命令</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n136"><a class="md-toc-inner" href="#实作一-7">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n139"><a class="md-toc-inner" href="#实作二-6">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n143"><a class="md-toc-inner" href="#实作三-2">实作三</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n146"><a class="md-toc-inner" href="#实验八">实验八</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n147"><a class="md-toc-inner" href="#cache">cache</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n150"><a class="md-toc-inner" href="#实作一-8">实作一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n155"><a class="md-toc-inner" href="#实作二-7">实作二</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n159"><a class="md-toc-inner" href="#wireshark-实验">Wireshark 实验</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n160"><a class="md-toc-inner" href="#数据链路层">数据链路层</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n161"><a class="md-toc-inner" href="#实作一-熟悉-ethernet-帧结构">实作一 熟悉 Ethernet 帧结构</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n165"><a class="md-toc-inner" href="#问题-2"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n168"><a class="md-toc-inner" href="#实作二-了解子网内外通信时的-mac-地址">实作二 了解子网内/外通信时的 MAC 地址</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n185"><a class="md-toc-inner" href="#问题-3">问题</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n188"><a class="md-toc-inner" href="#实作三-掌握-arp-解析过程">实作三 掌握 ARP 解析过程</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n203"><a class="md-toc-inner" href="#问题-4"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n213"><a class="md-toc-inner" href="#网络层">网络层</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n214"><a class="md-toc-inner" href="#实作一-熟悉-ip-包结构">实作一 熟悉 IP 包结构</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n217"><a class="md-toc-inner" href="#问题-5"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n220"><a class="md-toc-inner" href="#实作二-ip-包的分段与重组">实作二 IP 包的分段与重组</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n227"><a class="md-toc-inner" href="#问题-6"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n230"><a class="md-toc-inner" href="#实作三-考察-ttl-事件">实作三 考察 TTL 事件</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n238"><a class="md-toc-inner" href="#问题-7"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n241"><a class="md-toc-inner" href="#传输层">传输层</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n242"><a class="md-toc-inner" href="#实作一-熟悉-tcp-和-udp-段结构">实作一 熟悉 TCP 和 UDP 段结构</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n250"><a class="md-toc-inner" href="#问题-8"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n253"><a class="md-toc-inner" href="#实作二-分析-tcp-建立和释放连接">实作二 分析 TCP 建立和释放连接</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n268"><a class="md-toc-inner" href="#问题一-2">问题一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n271"><a class="md-toc-inner" href="#问题二-2"><strong>问题二</strong></a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n274"><a class="md-toc-inner" href="#应用层">应用层</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n276"><a class="md-toc-inner" href="#实作一-了解-dns-解析">实作一 了解 DNS 解析</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n285"><a class="md-toc-inner" href="#问题-9"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n288"><a class="md-toc-inner" href="#实作二-了解-http-的请求和应答">实作二 了解 HTTP 的请求和应答</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n300"><a class="md-toc-inner" href="#问题-10"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n303"><a class="md-toc-inner" href="#cisco-packet-tracer-实验">Cisco Packet Tracer 实验</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n304"><a class="md-toc-inner" href="#1直接连接两台-pc-构建-lan">1.直接连接两台 PC 构建 LAN</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n306"><a class="md-toc-inner" href="#2用交换机构建-lan">2.用交换机构建 LAN</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n333"><a class="md-toc-inner" href="#问题-11"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n358"><a class="md-toc-inner" href="#3交换机接口地址列表">3.交换机接口地址列表</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n365"><a class="md-toc-inner" href="#4生成树协议spanning-tree-protocol）">4.生成树协议（Spanning Tree Protocol）</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n376"><a class="md-toc-inner" href="#5路由器配置初步">5.路由器配置初步</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n381"><a class="md-toc-inner" href="#说明一">说明一</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n391"><a class="md-toc-inner" href="#说明二">说明二</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n394"><a class="md-toc-inner" href="#说明三">说明三</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n396"><a class="md-toc-inner" href="#说明四">说明四</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n410"><a class="md-toc-inner" href="#说明五">说明五</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n412"><a class="md-toc-inner" href="#说明六">说明六</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n466"><a class="md-toc-inner" href="#交通大学路由器基本配置如下">交通大学路由器基本配置如下：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n471"><a class="md-toc-inner" href="#重庆大学路由器基本配置如下">重庆大学路由器基本配置如下：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n484"><a class="md-toc-inner" href="#问题-12"><strong>问题</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n487"><a class="md-toc-inner" href="#6静态路由">6.静态路由</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n491"><a class="md-toc-inner" href="#交通大学路由器静态路由配置">交通大学路由器静态路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n494"><a class="md-toc-inner" href="#重庆大学路由器静态路由配置">重庆大学路由器静态路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n501"><a class="md-toc-inner" href="#7动态路由-rip">7.动态路由 RIP</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n505"><a class="md-toc-inner" href="#清除静态路由配置">清除静态路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n513"><a class="md-toc-inner" href="#交通大学路由器-rip-路由配置">交通大学路由器 RIP 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n516"><a class="md-toc-inner" href="#重庆大学路由器-rip-路由配置">重庆大学路由器 RIP 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n523"><a class="md-toc-inner" href="#8动态路由-ospf">8.动态路由 OSPF</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n526"><a class="md-toc-inner" href="#清除-rip-路由配置">清除 RIP 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n534"><a class="md-toc-inner" href="#交通大学路由器-ospf-路由配置-1">交通大学路由器 OSPF 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n537"><a class="md-toc-inner" href="#重庆大学路由器-ospf-路由配置-1">重庆大学路由器 OSPF 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n543"><a class="md-toc-inner" href="#反向掩码"><strong>反向掩码</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n549"><a class="md-toc-inner" href="#9基于端口的网络地址翻译-pat">9.基于端口的网络地址翻译 PAT</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n613"><a class="md-toc-inner" href="#交通大学路由器接口配置如下">交通大学路由器接口配置如下：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n618"><a class="md-toc-inner" href="#重庆大学路由器接口配置如下">重庆大学路由器接口配置如下：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n623"><a class="md-toc-inner" href="#交通大学路由器-ospf-路由配置-2">交通大学路由器 OSPF 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n625"><a class="md-toc-inner" href="#重庆大学路由器-ospf-路由配置-2">重庆大学路由器 OSPF 路由配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n632"><a class="md-toc-inner" href="#重庆大学路由器丢包的配置">重庆大学路由器丢包的配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n639"><a class="md-toc-inner" href="#交通大学路由器-pat-配置">交通大学路由器 PAT 配置：</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n645"><a class="md-toc-inner" href="#10虚拟局域网-vlan">10.虚拟局域网 VLAN</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n655"><a class="md-toc-inner" href="#交换机-vlan-配置">交换机 VLAN 配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n722"><a class="md-toc-inner" href="#✎-思考">✎ <strong>思考</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n725"><a class="md-toc-inner" href="#11虚拟局域网管理-vtp">11.虚拟局域网管理 VTP</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n745"><a class="md-toc-inner" href="#3560-vtp-server-配置">3560 VTP Server 配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n757"><a class="md-toc-inner" href="#2960a左边）-vtp-client-配置">2960A（左边） VTP Client 配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n769"><a class="md-toc-inner" href="#2960b右边）-vtp-client-配置">2960B（右边） VTP Client 配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n816"><a class="md-toc-inner" href="#✎-试一试-1">✎ <strong>试一试</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n820"><a class="md-toc-inner" href="#12vlan-间的通信">12.VLAN 间的通信</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n824"><a class="md-toc-inner" href="#3560-交换机配置">3560 交换机配置：</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n827"><a class="md-toc-inner" href="#✎-试一试-2">✎ <strong>试一试</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n836"><a class="md-toc-inner" href="#13dhcpdns及web服务器简单配置">13.DHCP、DNS及Web服务器简单配置</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n862"><a class="md-toc-inner" href="#✎-试一试-3">✎ <strong>试一试</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n870"><a class="md-toc-inner" href="#14wlan初步配置">14.WLAN初步配置</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n874"><a class="md-toc-inner" href="#📬-秘籍">📬 秘籍</a></span></p></div><h2 id='验证性实验'><span>验证性实验</span></h2><h3 id='实验一'><span>实验一</span></h3><h4 id='ipconfig'><span>Ipconfig</span></h4><p><span>      </span><code>ipconfig</code><span> 是微软操作系统的计算机上用来控制网络连接的一个命令行工具。它的主要用来显示当前网络连接的配置信息（</span><code>/all</code><span> 参数）。</span></p><h5 id='常用命令-1'><span>常用命令</span></h5><p><span>   若要显示所有适配器的基本 TCP/IP 配置，请键入：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ipconfig</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>若要显示所有适配器的完整 TCP/IP 配置，请键入：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ipconfig /all</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>若要仅为&quot;本地连接&quot;适配器续订 DHCP 分配的 IP 地址配置，请键入：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ipconfig /renew Local Area Connection</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>若要在排查 DNS 名称解析问题时刷新 DNS 解析程序缓存，请键入：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ipconfig /flushdns</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>若要显示名称以 Local 开始的所有适配器的 DHCP 类 ID，请键入：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ipconfig /showclassid Local*</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>若要将&quot;局部区域连接&quot;适配器的 DHCP 类 ID 设置为 TEST，请键入：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ipconfig /setclassid Local Area Connection TEST</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><h5 id='实作一-1'><span>实作一</span></h5><p><span>  使用 </span><code>ipconfig/all</code><span> 查看</span><strong><span>自己</span></strong><span>计算机的网络配置，尽可能明白每行的意思，特别注意 </span><code>IP</code><span> 地址、子网掩码 </span><code>Subnet Mask</code><span>、网关 </span><code>Gateway</code><span>。</span></p><p><span>   </span><img src="./img/Ipconfig-1.png" style="zoom:60%;" /></p><h5 id='实作二-1'><span>实作二</span></h5><p><img src="./img/Ipconfig-1.png" style="zoom:60%;" /></p><p><span>该图是放在虚拟机下生成的Linux版本ipconfig,由图可知位于同一子网。</span></p><h3 id='实验二'><span>实验二</span></h3><p>&nbsp;</p><h4 id='ping'><span>ping</span></h4><p><code>ping</code><span>（Packet Internet Groper），因特网包探索器，用于测试网络连接量的程序 。</span><code>ping</code><span> 是工作在 TCP/IP 网络体系结构中应用层的一个服务命令， 主要是向特定的目的主机发送 ICMP（Internet Control Message Protocol 因特网报文控制协议）Echo 请求报文，测试目的站是否可达及了解其有关状态。</span></p><h4 id='常用命令-2'><span>常用命令</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-t ：Ping 指定的计算机直到中断。</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-a ：将地址解析为计算机名。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-n count ：发送 count 指定的 ECHO 数据包数。默认值为 4。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-l size ：发送包含由 size 指定的数据量的 ECHO 数据包。默认为 32 字节；最大值是65,527。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-f ：在数据包中发送"不要分段"标志。数据包就不会被路由上的网关分段。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-i ttl :将"生存时间"字段设置为 ttl 指定的值。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-v tos :将"服务类型"字段设置为 tos 指定的值。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-r count :在"记录路由"字段中记录传出和返回数据包的路由。count 可以指定最少 1 台，最多 9 台计算机。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-s count :指定 count 指定的跃点数的时间戳。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-j host-list :利用 host-list 指定的计算机列表路由数据包。连续计算机可以被中间网关分隔（路由稀疏源）IP 允许的最大数量为 9。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-k host-list :利用 host-list 指定的计算机列表路由数据包。连续计算机不能被中间网关分隔（路由严格源）IP 允许的最大数量为 9。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-w timeout :指定超时间隔，单位为毫秒。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">destination-list :指定要 ping 的远程计算机。</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 560px;"></div><div class="CodeMirror-gutters" style="display: none; height: 560px;"></div></div></div></pre><p>&nbsp;</p><h5 id='实作一-2'><span>实作一</span></h5><p><span>    要测试到某计算机如 重庆交通大学 Web 服务器的连通性，可以使用 </span><code>ping www.cqjtu.edu.cn</code><span> 命令，也可直接使用 IP 地址。</span></p><p><span>请掌握使用该命令后屏幕显示的反馈回来信息的意思，如：TTL、时间等。</span></p><p><span>    </span><img src="./img/ping-1.png" style="zoom:60%;" /></p><p><span>可得IP地址为218.70.34.236.</span></p><h5 id='实作二-2'><span>实作二</span></h5><p><span>    使用 </span><code>ping/?</code><span> 命令了解该命令的各种选项并实际使用。</span></p><p><span> </span><img src="./img/ping-2.png" style="zoom:60%;" /></p><h6 id='1使用-ping--t'><span>1.使用 ping -t</span></h6><p><span>不间断地ping指定计算机，知道管理员中断。</span></p><p><span>   </span><img src="./img/ping-3.png" style="zoom:60%;" /></p><p>&nbsp;</p><h6 id='2使用ping--a'><span>2.使用ping -a</span></h6><p><span> Ping-a解析计算机名与NetBios名。就是可以通过ping它的IP地址，可以解析出主机名</span></p><p><img src="./img/ping-4.png" style="zoom:60%;" /></p><p><span>学校iP地址应该有防火墙设置 得不到主机名字</span></p><h6 id='3使用ping--n'><span>3.使用ping -n</span></h6><p><span> 该方法指定了发送包数量 一般默认为4</span></p><h6 id='4使用ping-i-size'><span>4.使用ping-I size</span></h6><p><span>  在默认的情况下Windows的ping发送的数据包大小为32byte，最大能发送65500byte。当一次发送的数据包大于或等于65500byte时，将可能导致接收方计算机宕机。所以微软限制了这一数值；这个参数配合其它参数以后危害非常强大，比如攻击者可以结合-t参数实施DOS攻击。（所以它具有危险性，不要轻易向别人计算机使用）。</span></p><p><span> </span><img src="./img/ping-5.png" style="zoom:60%;" /></p><h6 id='6使用ping-r-count'><span>6.使用ping-r count</span></h6><p><span>  在“记录路由”字段中记录传出和返回数据包的路由，探测经过的路由个数，但最多只能跟踪到9个路由。</span></p><p><span> 尝试过许多IP地址现在都不返回经过路由了</span></p><h6 id='7其他ping-问题'><span>7.其他ping 问题</span></h6><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">TroubleShooting——</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">假设你不能 `ping` 通某计算机或 IP，但你确定该计算机和你之间的网络是连通的，那么可能的原因是什么？该如何处理能保证 `ping` 通？</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">答：可能的原因是对方服务器关闭了，让对方开启即可</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 67px;"></div><div class="CodeMirror-gutters" style="display: none; height: 67px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">📬 秘籍</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">当你的网络出现故障不能访问某计算机如 `14.215.177.39` (百度的 IP 地址之一 ) 时，我们一般可采用由近及远的连通性测试来确定问题所在。现假设你的 IP 是 `192.168.1.89`，你旁边计算机的 IP 是 `192.168.1.64`，网关的 IP 是 `192.168.1.1` ，那么过程如下：</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">1. `ping 127.0.0.1` ，测试自己计算机的状态，如果 OK，那么说明本机网络软件硬件工作正常，否则，问题在本机，检查本机 TCP/IP 配置即网卡状态等</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2. `ping 192.168.1.64` ，测试到旁边计算机的连通性，如果OK，那么说明本子网内部工作正常，否则，问题在本机网络出口到交换机之间，检查本机网卡到交换机的连线等</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3. `ping 192.168.1.1`，测试到网关的连通性，如果 OK，那么说明本子网出口工作正常，否则，问题在网关，这是你无能为力的事情，报告给网管</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">4. `ping 14.215.177.39`，测试到百度的连通性，如果 OK，那就 OK，否则，问题在网关以外，这也是你无能为力的事情，报告给网管或者李彦宏？</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">假设在秘籍中进行的网络排查中，`ping` 百度的 IP 即 `ping 14.215.177.39` 没问题，但 `ping` 百度的域名即 `ping www.baidu.com` 不行，那么可能的原因是什么？如何进行验证和解决？</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">另外，经常有同学问到的："能上 QQ，但不能上网" 跟这个问题的原因是相似的。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">答：可能的原因是 DNS 发生故障或设置错误而导致解析失败，因为域名是需要经过当地的 DNS 服务器解析成 IP ，再根据 IP 发送数据测试包。</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">验证和解决：1、咨询当地电信部门，是否当地 DNS 服务器故障；2、百度搜索当地 DNS 服务器地址，检查当前 DNS 服务器设置是否正确；3、可临时设置 DNS 服务器地址为 8.8.8.8，该服务器延迟会比较大。</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 493px;"></div><div class="CodeMirror-gutters" style="display: none; height: 493px;"></div></div></div></pre><h3 id='实验三'><span>实验三</span></h3><h4 id='tracert'><span>tracert</span></h4><p><code>TRACERT</code><span> (Trace Route 的组合缩写)，也称为路由追踪，该命令行程序可用于跟踪 Internet 协议 （IP） 数据包传送到目标地址时经过的路径。</span></p><h4 id='常用命令-3'><span>常用命令</span></h4><p><img src="./img/tracer-1.png" style="zoom:60%;" /></p><h5 id='实作一-3'><span>实作一</span></h5><p><span>   要了解到某计算机如 </span><a href='http://www.cqjtu.edu.cn/'><span>www.baidu.com</span></a><span> 中间经过了哪些节点（路由器）及其它状态，可使用 </span><code>tracert www.baidu.com</code><span>命令，查看反馈的信息，了解节点的个数。</span></p><p><span>  </span><img src="./img/tracer-2.png" style="zoom:60%;" /></p><h5 id='实作二-3'><span>实作二</span></h5><p><span>  ping.ge这个网站可以探测从全球主要的 ISP 到某站点如 </span><a href='https://qige.io/'><span>https://qige.io</span></a><span> 的线路状态，当然也包括各线路到该主机的路由情况。请使用浏览器访问 </span><a href='http://ping.pe/qige.io' target='_blank' class='url'>http://ping.pe/qige.io</a><span> 进行了解。</span></p><p><img src="./img/tracer-3.png" style="zoom:60%;" /></p><p><span>问题一</span></p><p><span>   tracert 能告诉我们路径上的节点以及大致的延迟等信息，那么它背后的原理是什么？本问题可结合第二部分的 Wireshark 实验进行验证。</span></p><p><span>答：无论什么都是通过路由器在通过浏览器访问的</span></p><p><span> 问题二</span></p><p><span>   在以上两个实作中，如果你留意路径中的节点，你会发现无论是访问百度还是棋歌教学网，路径中的第一跳都是相同的，甚至你应该发现似乎前几个节点都是相同的，你的解释是什么？</span></p><p><span>答：我们是处于内网，传输数据首先要到达网关。</span></p><p><span>问题三</span></p><p><span>   在追踪过程中，你可能会看到路径中某些节点显示为 * 号，这是发生了什么？</span></p><p><span>答：没有出现信息反馈。</span></p><h3 id='实验四'><span>实验四</span></h3><h4 id='arp'><span>ARP</span></h4><p><span>   ARP（Address Resolution Protocol）即地址解析协议，是用于根据给定网络层地址即 IP 地址，查找并得到其对应的数据链路层地址即 MAC地址的协议。 ARP 协议定义在 1982 年的 RFC 826。</span></p><h4 id='常用命令-4'><span>常用命令</span></h4><p><span>       </span><img src="./img/arp-1.png" style="zoom:60%;" /></p><h5 id='实作一-4'><span>实作一</span></h5><p><span>    运行 </span><code>arp -a</code><span> 命令查看当前的 arp 缓存， 请留意缓存了些什么。</span></p><p><span>然后 </span><code>ping</code><span> 一下你旁边的计算机 IP（注意，需保证该计算机的 IP 没有出现在 arp 缓存中，或者使用 </span><code>arp -d *</code><span> 先删除全部缓存），再次查看缓存，你会发现一些改变，请作出解释。</span></p><p><img src="./img/arp-2.png" style="zoom:60%;" /></p><p><img src="./img/ping-1.png" style="zoom:60%;" /></p><h5 id='实作二-4'><span>实作二</span></h5><p><span>   请使用 </span><code>arp /?</code><span> 命令了解该命令的各种选项。</span></p><p><img src="./img/arp-1.png" style="zoom:60%;" /></p><h5 id='实作三-1'><span>实作三</span></h5><p><span>  一般而言，arp 缓存里常常会有网关的缓存，并且是动态类型的。</span></p><p><span>假设当前网关的 IP 地址是 </span><code>192.168.0.1</code><span>，MAC 地址是 </span><code>5c-d9-98-f1-89-64</code><span>，请使用 </span><code>arp -s 192.168.0.1 5c-d9-98-f1-89-64</code><span> 命令设置其为静态类型的。</span></p><p><img src="./img/arp-3.png" style="zoom:60%;" /></p><h6 id='问题一-1'><span>问题一</span></h6><p><strong><span>你可能会在实作三的操作中得到 &quot;ARP 项添加失败: 请求的操作需要提升&quot; 这样的信息，表示命令没能执行成功，你该如何解决？</span></strong></p><p><span>答案：给予管理员权限</span></p><h6 id='问题二-1'><strong><span>问题二</span></strong></h6><p><strong><span>在实作三中，为何缓存中常常有网关的信息？</span></strong></p><p><strong><span>我们将网关或其它计算机的 arp 信息设置为静态有什么优缺点？</span></strong></p><p><span>答：因为缓存记录的就自己访问的IP和MAC地址。</span>
<span>静态ARP表项通过手工配置和维护，不会被老化，不会被动态ARP表项覆盖。配置静态ARP表项可以增加通信的安全性。静态ARP表项可以限制和指定IP地址的设备通信时只使用指定的MAC地址，此时攻击报文无法修改此表项的IP地址和MAC地址的映射关系，从而保护了本设备和指定设备间的正常通信。</span></p><h3 id='实验五'><span>实验五</span></h3><h4 id='dhcp'><span>DHCP</span></h4><p><span>    DHCP（Dynamic Host Configuration Protocol）即动态主机配置协议，是一个用于 IP 网络的网络协议，位于 OSI 模型的应用层，使用 UDP 协议工作，主要有两个用途：</span></p><p><span>用于内部网或网络服务供应商自动分配 IP 地址给用户</span>
<span>用于内部网管理员对所有电脑作中央管理</span>
<span>简单的说，DHCP 可以让计算机自动获取/释放网络配置。</span></p><h4 id='实作一-5'><span>实作一</span></h4><p><span>  一般地，我们自动获取的网络配置信息包括：IP 地址、子网掩码、网关 IP 以及 DNS 服务器 IP 等。使用 </span><code>ipconfig/release</code><span> 命令释放自动获取的网络配置，并用 </span><code>ipconfig/renew</code><span> 命令重新获取，了解 DHCP 工作过程和原理。</span></p><p><span>   </span><img src="./img/DHCP-1.png" style="zoom:60%;" /></p><h6 id='问题-1'><span>问题</span></h6><p><span>   </span><strong><span>在Windows系统下，如果由于某种原因计算机不能获取 DHCP 服务器的配置数据，那么Windows将会根据某种算法自动配置为 169.254.x.x 这样的 IP 地址。显然，这样的 IP 以及相关的配置信息是不能让我们真正接入 Internet 的，为什么？既然不能接入 Internet，那么Winodws系统采用这样的方案有什么意义？</span></strong></p><p><span>答：自动配置的IP地址和信息只是短暂性的解决计算机不能获取 DHCP 服务器的配置数据的问题，要真正的接入Internet还是得本身计算机的正确IP地址。意义：假如某天因 DHCP 服务器问题从而不能获得网络配置，那么我们可以查看隔壁教室计算机的配置信息来手动进行网络配置，从而使该计算机能够接入 Internet。</span></p><h6 id='秘籍'><span>秘籍</span></h6><p><span>  </span><strong><span>在我校不少地方如教室，计算机都采用了 DHCP 来获得网络配置。假如某天因 DHCP 服务器问题从而不能获得网络配置，那么我们可以查看隔壁教室计算机的配置信息来手动进行网络配置，从而使该计算机能够接入 Internet。</span></strong></p><p><strong><span>经常的，在一个固定地方的网络配置我都喜欢采用 静态/手动配置，而不是动态 DHCP 来进行。你能想到是什么原因吗？</span></strong></p><p><span>答：因为 DHCP 维护的地址池是有限的，那么我可以不停的发出 DHCP 请求，从而导致 DHCP 地址耗尽。然后我自己再运行一个 DHCP 服务器来提供虚假的网络信息，特别是伪造的网关和 DNS 信息。手动配置没有自动请求分配地址的时间延迟网络连接更迅速;每台机器IP固定,更便于网络管理和使用。</span></p><h3 id='实验六'><span>实验六</span></h3><h4 id='netstat'><span>netstat</span></h4><p><span>  无论是使用 TCP 还是 UDP，任何一个网络服务都与特定的端口（Port Number）关联在一起。因此，每个端口都对应于某个通信协议/服务。</span></p><p><code>netstat</code><span>（Network Statistics）是在内核中访问网络连接状态及其相关信息的命令行程序，可以显示路由表、实际的网络连接和网络接口设备的状态信息，以及与 IP、TCP、UDP 和 ICMP 协议相关的统计数据，一般用于检验本机各端口的网络服务运行状况。</span></p><h4 id='重用命令'><span>重用命令</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-a或–all：显示所有连线中的Socket； </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-A&lt;网络类型&gt;或–&lt;网络类型&gt;：列出该网络类型连线中的相关地址； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-c或–continuous：持续列出网络状态； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-C或–cache：显示路由器配置的快取信息； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-e或–extend：显示网络其他相关信息； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-F或–fib：显示FIB； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-g或–groups：显示多重广播功能群组组员名单； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-h或–help：在线帮助； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-i或–interfaces：显示网络界面信息表单； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-l或–listening：显示监控中的服务器的Socket； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-M或–masquerade：显示伪装的网络连线； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-n或–numeric：直接使用ip地址，而不通过域名服务器； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-N或–netlink或–symbolic：显示网络硬件外围设备的符号连接名称； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-o或–timers：显示计时器； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-p或–programs：显示正在使用Socket的程序识别码和程序名称； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-r或–route：显示Routing Table； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-s或–statistice：显示网络工作信息统计表； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-t或–tcp：显示TCP传输协议的连线状况； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-u或–udp：显示UDP传输协议的连线状况； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-v或–verbose：显示指令执行过程； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-V或–version：显示版本信息； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-w或–raw：显示RAW传输协议的连线状况； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-x或–unix：此参数的效果和指定”-A unix”参数相同； </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">–ip或–inet：此参数的效果和指定”-A inet”参数相同。</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 538px;"></div><div class="CodeMirror-gutters" style="display: none; height: 538px;"></div></div></div></pre><p>&nbsp;</p><h5 id='实作一-6'><span>实作一</span></h5><p><span>Windows 系统将一些常用的端口与服务记录在 </span><code>C:\WINDOWS\system32\drivers\etc\services</code><span> 文件中，请查看该文件了解常用的端口号分配。</span></p><p><img src="./img/netstat-1.png" style="zoom:60%;" /></p><h5 id='实作二-5'><span>实作二</span></h5><p><span>使用 </span><code>netstat -an</code><span> 命令，查看计算机当前的网络连接状况。更多的 </span><code>netstat</code><span> 命令选项</span></p><p><img src="./img/netstat-2.png" style="zoom:60%;" /></p><h3 id='实验七'><span>实验七</span></h3><h4 id='dns'><span>DNS</span></h4><p><span>   DNS（Domain Name System）即域名系统，是互联网的一项服务。它作为将域名和 IP 地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。DNS 使用 TCP 和 UDP 的 53 号端口。</span></p><h4 id='nslookup常用命令'><span>nslookup常用命令</span></h4><p><span>  </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">nslookup # 进入交互模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">域名  # 进行正向解析</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">IP地址  # 进行反向解析(有些地址不能反向解析)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">lserver + IP地址  # 更换DNS服务器</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">set all  # 显示当前的查询设置</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">set type =MX  # 查询邮件交换记录</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">set type =ns  # 查询某子域的域名服务器</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">set type =AAAA &nbsp;  #查询域名对应的IPv6地址(查询IPv6站点有效:如bbs6.ustc.edu.cn)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">设置完成后再进行查询即可</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 202px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></pre><h5 id='实作一-7'><span>实作一</span></h5><p><span>Windows 系统将一些固定的/静态的 DNS 信息记录在 </span><code>C:\WINDOWS\system32\drivers\etc\hosts</code><span> 文件中，如我们常用的 </span><code>localhost</code><span> 就对应 </span><code>127.0.0.1</code><span> 。请查看该文件看看有什么记录在该文件中。</span></p><p><img src="./img/DNS-1.png" style="zoom:60%;" /></p><h5 id='实作二-6'><span>实作二</span></h5><p><span>    解析过的 DNS 记录将会被缓存，以利于加快解析速度。请使用 </span><code>ipconfig /displaydns</code><span> 命令查看。我们也可以使用 </span><code>ipconfig /flushdns</code><span> 命令来清除所有的 DNS 缓存。</span></p><p><img src="./img/DNS-2.png" style="zoom:60%;" /></p><p><img src="./img/DNS-4.png" referrerpolicy="no-referrer"></p><h5 id='实作三-2'><span>实作三</span></h5><p><span>     使用 </span><code>nslookup qige.io</code><span> 命令，将使用默认的 DNS 服务器查询该域名。当然你也可以指定使用 </span><code>CloudFlare</code><span>（</span><code>1.1.1.1</code><span>）或 </span><code>Google</code><span>（</span><code>8.8.8.8</code><span>） 的全球 DNS 服务器来解析，如：</span><code>nslookup qige.io 8.8.8.8，当然，由于你懂的原因，这不一定会得到正确的答案。</code></p><p><img src="./img/DNS-3.png" style="zoom:100%;" /></p><h3 id='实验八'><span>实验八</span></h3><h4 id='cache'><span>cache</span></h4><p><span>   Cache 即缓存，是 IT 领域一个重要的技术。我们此处提到的 cache 主要是浏览器缓存。</span></p><p><span>浏览器缓存是根据 HTTP 报文的缓存标识进行的，是性能优化中简单高效的一种优化方式了。一个优秀的缓存策略可以缩短网页请求资源的距离，减少延迟，并且由于缓存文件可以重复利用，还可以减少带宽，降低网络负荷。</span></p><h5 id='实作一-8'><span>实作一</span></h5><p><span>    打开 Chrome 或 Firefox 浏览器，访问 </span><a href='https://qige.io' target='_blank' class='url'>https://qige.io</a><span> ，接下来敲 </span><code>F12</code><span> 键 或 </span><code>Ctrl + Shift + I</code><span> 组合键打开开发者工具，选择 </span><code>Network</code><span> 面板后刷新页面，你会在开发者工具底部看到加载该页面花费的时间。请进一步查看哪些文件被 cache了，哪些没有。</span></p><p>&nbsp;</p><p><img src="./img/cache-1.png" style="zoom:60%;" /></p><p><span> 从图中即可看出哪些文件被cache</span></p><h5 id='实作二-7'><span>实作二</span></h5><p><span>    接下来仍在 </span><code>Network</code><span> 面板，选择 </span><code>Disable cache</code><span> 选项框，表明当前不使用 cache，页面数据全部来自于 Internet，刷新页面，再次在开发者工具底部查看加载该页面花费的时间。你可比对与有 cache 时的加载速度差异。</span></p><p><img src="./img/cache-2.png" style="zoom:60%;" /></p><p><span>上幅图片显示加载用了227ms 选择了Disable cache 后明显加载时间增加 时间耗费了1.23s</span></p><h2 id='wireshark-实验'><span>Wireshark 实验</span></h2><h3 id='数据链路层'><span>数据链路层</span></h3><h4 id='实作一-熟悉-ethernet-帧结构'><span>实作一 熟悉 Ethernet 帧结构</span></h4><p><span>使用 Wireshark 任意进行抓包，熟悉 Ethernet 帧的结构，如：目的 MAC、源 MAC、类型、字段等。</span></p><p><img src="./img/数据链路层-1.png" style="zoom:100%;" /></p><p><span>目的 MAC、源 MAC经过加密处理，次处类型为IPV4.</span></p><h5 id='问题-2'><strong><span>问题</span></strong></h5><p><span>你会发现 Wireshark 展现给我们的帧中没有校验字段，请了解一下原因</span></p><p><span>答：Wireshark 会忽略此检验字段</span></p><h4 id='实作二-了解子网内外通信时的-mac-地址'><span>实作二 了解子网内/外通信时的 MAC 地址</span></h4><ol start='' ><li><p><code>ping</code><span> 你旁边的计算机（同一子网），同时用 Wireshark 抓这些包（可使用 icmp 关键字进行过滤以利于分析），记录一下发出帧的目的 MAC 地址以及返回帧的源 MAC 地址是多少？这个 MAC 地址是谁的？</span></p><p><img src="./img/数据链路层-2.png" referrerpolicy="no-referrer"></p><p><img src="./img/数据链路层-3.png" referrerpolicy="no-referrer"></p><p><span>发出帧的目的 MAC 地址以及返回帧的源 MAC 地址是zte_00:00:00(34:4b:50:00:00:00) 这个地址是ping 对象的</span></p></li><li><p><span>然后 </span><code>ping qige.io</code><span> （或者本子网外的主机都可以），同时用 Wireshark 抓这些包（可 icmp 过滤），记录一下发出帧的目的 MAC 地址以及返回帧的源 MAC 地址是多少？这个 MAC 地址是谁的？</span></p><p><img src="./img/数据链路层-4.png" referrerpolicy="no-referrer"></p><p><img src="./img/数据链路层-5.png" referrerpolicy="no-referrer"></p><p><span>发出帧的目的 MAC 地址以及返回帧的源 MAC 地址是zte_32:84:18(c8:ea:f8:32:84:18) 这个地址是qige.io的服务器MAC地址</span></p></li><li><p><span>再次 </span><code>ping www.cqjtu.edu.cn</code><span> （或者本子网外的主机都可以），同时用 Wireshark 抓这些包（可 icmp 过滤），记录一下发出帧的目的 MAC 地址以及返回帧的源 MAC 地址又是多少？这个 MAC 地址又是谁的？</span></p></li></ol><p><img src="./img/数据链路层-6.png" referrerpolicy="no-referrer"></p><p><img src="./img/数据链路层-7.png" referrerpolicy="no-referrer"></p><p><span>发出帧的目的 MAC 地址以及返回帧的源 MAC 地址是zte_32:84:18(c8:ea:f8:32:84:18) 这个地址是</span><a href='http://www.cqjtu.edu.cn' target='_blank' class='url'>www.cqjtu.edu.cn</a><span>的服务器MAC地址</span></p><h5 id='问题-3'><span>问题</span></h5><p><span>通过以上的实验，你会发现：</span>
<span>访问本子网的计算机时，目的 MAC 就是该主机的，访问非本子网的计算机时，目的 MAC 是网关的</span>
<span>请问原因是什么？</span></p><p><span>因为本机接收到的本子网以外的信息必定经由网关发送给我，同理本机发送到本子往外信息的下个地址必定是网关的mac地址。而本子网内的可以直接到达。</span></p><h4 id='实作三-掌握-arp-解析过程'><span>实作三 掌握 ARP 解析过程</span></h4><ol start='' ><li><p><span>为防止干扰，先使用 </span><code>arp -d *</code><span> 命令清空 arp 缓存</span></p><p><img src="img/arp-4.png" style="zoom:67%;" /></p></li><li><p><code>ping</code><span> 你旁边的计算机（同一子网），同时用 Wireshark 抓这些包（可 arp 过滤），查看 ARP 请求的格式以及请求的内容，注意观察该请求的目的 MAC 地址是什么。再查看一下该请求的回应，注意观察该回应的源 MAC 和目的 MAC 地址是什么。</span></p><p><img src="img/arp-8.png" referrerpolicy="no-referrer"></p><p><img src="img/arp-5.png" referrerpolicy="no-referrer"></p></li><li><p><span>再次使用 </span><code>arp -d *</code><span> 命令清空 arp 缓存</span></p></li><li><p><span>然后 </span><code>ping qige.io</code><span> （或者本子网外的主机都可以），同时用 Wireshark 抓这些包（可 arp 过滤）。查看这次 ARP 请求的是什么，注意观察该请求是谁在回应。</span></p><p><img src="img/arp-6.png" style="zoom:60%;" /></p><p><img src="img/arp-7.png" style="zoom:60%;" /></p></li></ol><h5 id='问题-4'><strong><span>问题</span></strong></h5><p><span>通过以上的实验，你应该会发现，</span></p><ol start='' ><li><span>ARP 请求都是使用广播方式发送的</span></li><li><span>如果访问的是本子网的 IP，那么 ARP 解析将直接得到该 IP 对应的 MAC；如果访问的非本子网的 IP， 那么 ARP 解析将得到网关的 MAC。</span></li></ol><p><span>请问为什么？</span></p><p><span>答 ARP代理，访问非子网IP时是通过路由器访问的，路由器再把发出去，目标IP收到请求后，再通过路由器端口IP返回去，那么ARP解析将会得到网关的MAC</span></p><p>&nbsp;</p><h3 id='网络层'><span>网络层</span></h3><h4 id='实作一-熟悉-ip-包结构'><span>实作一 熟悉 IP 包结构</span></h4><p><span>使用 Wireshark 任意进行抓包（可用 ip 过滤），熟悉 IP 包的结构，如：版本、头部长度、总长度、TTL、协议类型等字段。</span></p><p><img src="./img/网络层1.png" style="zoom:60%;" /></p><h5 id='问题-5'><strong><span>问题</span></strong></h5><p><span>为提高效率，我们应该让 IP 的头部尽可能的精简。但在如此珍贵的 IP 头部你会发现既有头部长度字段，也有总长度字段。请问为什么？</span></p><p><span>答 ：便于传输时的识别IP总长度，节省时间，当长度超过15kb时就会被返回链路层进行分段。</span></p><h4 id='实作二-ip-包的分段与重组'><span>实作二 IP 包的分段与重组</span></h4><p><span>根据规定，一个 IP 包最大可以有 64K 字节。但由于 Ethernet 帧的限制，当 IP 包的数据超过 1500 字节时就会被发送方的数据链路层分段，然后在接收方的网络层重组。</span></p><p><span>缺省的，</span><code>ping</code><span> 命令只会向对方发送 32 个字节的数据。我们可以使用 </span><code>ping www.cqjtu.edu.cn</code><span>  -l 2000</span><code>命令指定要发送的数据长度。此时使用 Wireshark 抓包（用</code><span>ip.addr == 218.70.34.236 进行过滤），了解 IP 包如何进行分段，如：分段标志、偏移量以及每个包的大小等</span></p><p><img src="./img/网络层2.png" style="zoom:60%;" /></p><p>&nbsp;</p><p><img src="./img/网络层3.png" style="zoom:60%;" /></p><p><span>可以明显看到 分了两个包 因为最大1500，所以2000的包被分为了1500 和548 的两个包发出。</span></p><h5 id='问题-6'><strong><span>问题</span></strong></h5><p><span>分段与重组是一个耗费资源的操作，特别是当分段由传送路径上的节点即路由器来完成的时候，所以 IPv6 已经不允许分段了。那么 IPv6 中，如果路由器遇到了一个大数据包该怎么办？</span></p><p><span>答：IPv6 中，如果路由器遇到了一个大数据包会直接丢弃，然后通知发送端重新传输。</span></p><h4 id='实作三-考察-ttl-事件'><span>实作三 考察 TTL 事件</span></h4><p><span>在 IP 包头中有一个 TTL 字段用来限定该包可以在 Internet上传输多少跳（hops），一般该值设置为 64、128等。</span></p><p><span>在验证性实验部分我们使用了 </span><code>tracert</code><span> 命令进行路由追踪。其原理是主动设置 IP 包的 TTL 值，从 1 开始逐渐增加，直至到达最终目的主机。</span></p><p><span>请使用 </span><code>tracert www.baidu.com</code><span> 命令进行追踪，此时使用 Wireshark 抓包（用 </span><code>icmp</code><span> 过滤），分析每个发送包的 TTL 是如何进行改变的，从而理解路由追踪原理。</span></p><p><img src="./img/网络层4.png" style="zoom:60%;" /></p><p><img src="./img/网络层5.png" style="zoom:60%;" /></p><p><img src="./img/网络层6.png" style="zoom:60%;" /></p><p><span>TTL 虽然定义为生命期即 Time To Liv，每到达一个节点返回一个TTL信息，TTL逐渐增加1直到到达目的主机。</span></p><h5 id='问题-7'><strong><span>问题</span></strong></h5><p><span>在 IPv4 中，TTL 虽然定义为生命期即 Time To Live，但现实中我们都以跳数/节点数进行设置。如果你收到一个包，其 TTL 的值为 50，那么可以推断这个包从源点到你之间有多少跳？</span></p><p><span>答：至少50跳</span></p><h3 id='传输层'><span>传输层</span></h3><h4 id='实作一-熟悉-tcp-和-udp-段结构'><span>实作一 熟悉 TCP 和 UDP 段结构</span></h4><ol start='' ><li><p><span>用 Wireshark 任意抓包（可用 tcp 过滤），熟悉 TCP 段的结构，如：源端口、目的端口、序列号、确认号、各种标志位等字段。</span></p><p><img src="./img/传输层1.png" style="zoom:67%;" /></p></li><li><p><span>用 Wireshark 任意抓包（可用 udp 过滤），熟悉 UDP 段的结构，如：源端口、目的端口、长度等。</span></p><p><img src="./img/传输层2.png" style="zoom:67%;" /></p></li></ol><h5 id='问题-8'><strong><span>问题</span></strong></h5><p><span>由上大家可以看到 UDP 的头部比 TCP 简单得多，但两者都有源和目的端口号。请问源和目的端口号用来干什么？</span></p><p><span>答：源端口就是指本地端口，目的端口就是远程端口</span>
<span>源端口就是本机程序用来发送数据的端口，目的端口就是对方主机用哪个端口接收</span></p><h4 id='实作二-分析-tcp-建立和释放连接'><span>实作二 分析 TCP 建立和释放连接</span></h4><ol start='' ><li><p><span>打开浏览器访问 qige.io 网站，用 Wireshark 抓包（可用 tcp 过滤后再使用加上 </span><code>Follow TCP Stream</code><span>），不要立即停止 Wireshark 捕获，待页面显示完毕后再多等一段时间使得能够捕获释放连接的包。</span></p></li><li><p><span>请在你捕获的包中找到三次握手建立连接的包，并说明为何它们是用于建立连接的，有什么特征。</span></p><p><img src="./img/传输层3.png" style="zoom:80%;" /></p><p><span>注意到”第一次握手”客户端发送的TCP报文中以[SYN]作为标志位，并且客户端序号Seq=0；</span></p><p><span>接下来”第二次握手”服务器返回的TCP报文中以[SYN，ACK]作为标志位；并且服务器端序号Seq=0；确认号Ack=1(“第一次握手”中客户端序号Seq的值+1);</span></p><p><span>最后”第三次握手”客户端再向服务器端发送的TCP报文中以[ACK]作为标志位；其中客户端序号Seq=1（“第二次握手”中服务器端确认号Ack的值）；确认号Ack=1(“第二次握手”中服务器端序号Seq的值+1)。</span></p></li><li><p><span>请在你捕获的包中找到四次挥手释放连接的包，并说明为何它们是用于释放连接的，有什么特征。</span></p><p><img src="./img/传输层4.png" referrerpolicy="no-referrer"></p><p><span>第一次挥手”客户端发送的FIN请求释放连接报文以[FIN，ACK]作为标志位，其中报文序号Seq=800；确认号Ack=8785；</span>
<span>”第二次挥手”服务器端继续返回的FIN同意释放连接报文以[FIN，ACK]作为标志位；其中报文序号Seq=8809；确认号Ack=801；</span>
<span>”第三次挥手”客户端发出的ACK确认接收报文以[ACK]作为标志位；其中报文序号Seq=801；确认号Ack=8809；</span></p><p><span>第四次挥手没从中发现</span></p></li></ol><h5 id='问题一-2'><span>问题一</span></h5><p><span>去掉 </span><code>Follow TCP Stream</code><span>，即不跟踪一个 TCP 流，你可能会看到访问 </span><code>qige.io</code><span> 时我们建立的连接有多个。请思考为什么会有多个连接？作用是什么？</span></p><p><span>多个连接是为了更快的传输数据，为用户提供更好的服务。</span></p><h5 id='问题二-2'><strong><span>问题二</span></strong></h5><p><span>我们上面提到了释放连接需要四次挥手，有时你可能会抓到只有三次挥手。原因是什么？</span></p><p><span>答:是因为第二次握手和第三次挥手合并了，FIN报文用在本端没有数据发送给对方时，关闭从本端到对端的连接。但是并不影响从对方到本端的连接，也就是说本端仍然可以接收对方的数据。即发送通道关闭，接收通道正常。</span>
<span>如果对方收到本端FIN报文时，对方的接收通道就会关闭。此时，如果对方也没有数据发给本端，那么对方也会发送FIN给本端，用于关闭从对方到本端的连接，这时候就可能出现ACK和FIN合在一起的情况。</span>
<span>当然，如果对方仍然有数据发送，那么就等数据发完，再发FIN来关闭连接，这时候就是四次挥手了。</span></p><h3 id='应用层'><span>应用层</span></h3><p><span>应用层的协议非常的多，我们只对 DNS 和 HTTP 进行相关的分析。</span></p><h4 id='实作一-了解-dns-解析'><span>实作一 了解 DNS 解析</span></h4><ol start='' ><li><p><span>先使用 </span><code>ipconfig /flushdns</code><span> 命令清除缓存，再使用 </span><code>nslookup qige.io</code><span> 命令进行解析，同时用 Wireshark 任意抓包（可用 dns 过滤）。</span></p><p><img src="./img/DNS-6.png" style="zoom:60%;" /></p><p><img src="./img/DNS-5.png" style="zoom:60%;" /></p></li><li><p><span>你应该可以看到当前计算机使用 UDP，向默认的 DNS 服务器的 53 号端口发出了查询请求，而 DNS 服务器的 53 号端口返回了结果。</span></p><p><img src="img/DNS-7.png" style="zoom:60%;" /></p></li></ol><h5 id='问题-9'><strong><span>问题</span></strong></h5><p><span>你可能会发现对同一个站点，我们发出的 DNS 解析请求不止一个，思考一下是什么原因？</span></p><p><span>答：为了使服务器的负载得到平衡(因为每天访问站点的次数非常多）网站就设有好几个计算机，每一个计算机都运行同样的服务器软件。这些计算机的IP地址不一样，但它们的域名却是相同的。这样，第一个访问该网址的就得到第一个计算机的IP地址，而第二个访问者就得到第二个计算机的IP地址等等。这样可使每一个计算机的负荷不会太大。</span></p><h4 id='实作二-了解-http-的请求和应答'><span>实作二 了解 HTTP 的请求和应答</span></h4><ol start='' ><li><p><span>打开浏览器访问 qige.io 网站，用 Wireshark 抓包（可用http 过滤再加上 </span><code>Follow TCP Stream</code><span>），不要立即停止 Wireshark 捕获，待页面显示完毕后再多等一段时间以将释放连接的包捕获。</span></p></li><li><p><span>请在你捕获的包中找到 HTTP 请求包，查看请求使用的什么命令，如：</span><code>GET, POST</code><span>。并仔细了解请求的头部有哪些字段及其意义。</span></p><p><img src="img/Http-1.png" referrerpolicy="no-referrer"></p><p><span>Accept:告诉WEB服务器自己接受什么介质类型</span>
<span>Content-Type:WEB 服务器告诉浏览器自己响应的对象的类型</span>
<span>Content-Length:WEB 服务器告诉浏览器自己响应的对象的长度</span>
<span>Cache-Control:用来指示缓存系统（服务器上的，或者浏览器上的）应该怎样处理缓存</span>
<span>Host:客户端指定自己想访问的WEB服务器的域名/IP 地址和端口号</span>
<span>POST:请求的方式，其中包括URI和版本</span></p></li><li><p><span>请在你捕获的包中找到 HTTP 应答包，查看应答的代码是什么，如：</span><code>200, 304, 404</code><span> 等。并仔细了解应答的头部有哪些字段及其意义。</span></p><p><img src="img/Http-2.png" style="zoom:60%;" /></p><p><span>应答代码是200</span>
<span>Server：服务器通过这个头告诉浏览器服务器的类型。Transfer-Encoding：告诉浏览器数据的传送格式。Content- Type：表示后面的文档属于什么MIME类型。Cache-Control：指定请求和响应遵循的缓存机制</span></p></li></ol><h5 id='问题-10'><strong><span>问题</span></strong></h5><p><span>刷新一次 qige.io 网站的页面同时进行抓包，你会发现不少的 </span><code>304</code><span> 代码的应答，这是所请求的对象没有更改的意思，让浏览器使用本地缓存的内容即可。那么服务器为什么会回答 </span><code>304</code><span> 应答而不是常见的 </span><code>200</code><span> 应答？</span></p><p><span>答：浏览器中的缓存，可以直接在缓存区获取到需要的内容，不需要服务器在回复对应的内容，可以减少服务器的一些工作，减小开销。采用200应答就是要完全的将内容发送给客服端，这个会增加服务器的一些开销等</span></p><h2 id='cisco-packet-tracer-实验'><span>Cisco Packet Tracer 实验</span></h2><h4 id='1直接连接两台-pc-构建-lan'><span>1.直接连接两台 PC 构建 LAN</span></h4><p><img src="img/1.1.png" style="zoom:80%;" /></p><h4 id='2用交换机构建-lan'><span>2.用交换机构建 LAN</span></h4><p><span>构建如下拓扑结构的局域网：</span></p><p><img src="img/2.1.png" referrerpolicy="no-referrer"></p><p><span>各PC的基本网络配置如下表：</span></p><figure><table><thead><tr><th><strong><span>机器名</span></strong></th><th><strong><span>IP</span></strong></th><th style='text-align:left;' ><strong><span>子网掩码</span></strong></th></tr></thead><tbody><tr><td><span>PC0</span></td><td><span>192.168.1.1</span></td><td style='text-align:left;' ><span>255.255.255.0</span></td></tr><tr><td><span>PC1</span></td><td><span>192.168.1.2</span></td><td style='text-align:left;' ><span>255.255.255.0</span></td></tr><tr><td><span>PC2</span></td><td><span>192.168.2.1</span></td><td style='text-align:left;' ><span>255.255.255.0</span></td></tr><tr><td><span>PC3</span></td><td><span>192.168.2.2</span></td><td style='text-align:left;' ><span>255.255.255.0</span></td></tr></tbody></table></figure><p><img src="img/2.2.png" style="zoom:60%;" /></p><p><img src="img/2.8.png" style="zoom:67%;" /></p><h5 id='问题-11'><strong><span>问题</span></strong></h5><ol start='' ><li><p><span>PC0 能否 </span><code>ping</code><span> 通 PC1、PC2、PC3 ？</span></p><p><img src="img/2.3.png" style="zoom:60%;" /></p><p><img src="img/2.4.png" style="zoom:60%;" /></p><p><span>由上图得:PC0 能够Ping 通PC1，不能够Ping通 PC2 PC3</span></p></li><li><p><span>PC3 能否 </span><code>ping</code><span> 通 PC0、PC1、PC2 ？为什么？</span></p><p><span>PC3 能够Ping 通PC2 ，不能够Ping通 PC2 PC0 ,因为只能Ping通处于同一个子网下的</span></p></li><li><p><span>将 4 台 PC 的掩码都改为 </span><code>255.255.0.0</code><span> ，它们相互能 </span><code>ping</code><span> 通吗？为什么？</span></p><p><img src="img/2.5.png" style="zoom:60%;" /></p><p><img src="img/2.6.png" style="zoom:60%;" /></p><p><img src="img/2.9.png" style="zoom:67%;" /></p><p><span>它们相互能 </span><code>ping</code><span> 通 因为它们的IP地址与子网掩码相与得到的结果都是192.168.0.0，处于同一子网下，所以能ping通</span></p></li><li><p><span>使用二层交换机连接的网络需要配置网关吗？为什么？</span></p></li></ol><p><span>           如果只涉及局域网,在二层交换机中就不必配置网关</span></p><p><span>           如何涉及广域网  配置网关尤为重要，因为其与相连的自治系统可以向核心系统通告可达信息</span></p><p><span>  5.集线器 Hub 是工作在物理层的多接口设备，它与交换机的区别是什么？请在 CPT 软件中用 Hub 构建网络进行实际验证。</span></p><p><span>   集线器（HUB）是中继器的一种形式。它工作在物理层，与中继器一样，常用于两个网络节点之间物理信号的双向转发。完成信号的复制，调整和放大功能。不同的是HUB能提供多端口服务。</span></p><p><span>   交换机（SWITCH）类似于HUB，能连接两个局域网段。它工作在数据链路层，能起到过滤帧的作用。SWITCH检测帧的源地址及目的地址。如果在同一网络段则不转发。如果不在同一网段，就把帧转发到另一网段。</span></p><p><img src="img/2.7.png" style="zoom:60%;" /></p><p><span>一样可以Ping 通</span></p><h4 id='3交换机接口地址列表'><span>3.交换机接口地址列表</span></h4><p><span>  二层交换机是一种即插即用的多接口设备，它对于收到的帧有 3 种处理方式：广播、转发和丢弃（请弄清楚何时进行何种操作）。那么，要转发成功，则交换机中必须要有接口地址列表即 MAC 表，该表是交换机通过学习自动得到的！</span></p><p><span>   仍然构建上图的拓扑结构，并配置各计算机的 IP 在同一个一个子网，使用工具栏中的放大镜点击某交换机如左边的 Switch3，选择 </span><code>MAC Table</code><span>，可以看到最初交换机的 MAC 表是空的，也即它不知道该怎样转发帧（那么它将如何处理？）。</span></p><p><span>  </span><img src="img/3.1.png" style="zoom:60%;" /></p><p><span>用 PC0 访问（</span><code>ping</code><span>）PC1 后，再查看该交换机的 MAC 表，现在有相应的记录，请思考如何得来。随着网络通信的增加，各交换机都将生成自己完整的 MAC 表，此时交换机的交换速度就是最快的！</span></p><p><img src="img/3.2.png" style="zoom:60%;" /></p><p><span>交换机具有学习的能力每次接受到一个记录，则会将对应Mac地址放入自己表中，如果该Mac一定时间没有再次出现，则会被定期删除，在再次接受到该地址依旧学习。</span></p><h4 id='4生成树协议spanning-tree-protocol）'><span>4.生成树协议（Spanning Tree Protocol）</span></h4><p><span>   交换机在目的地址未知或接收到广播帧时是要进行广播的。如果交换机之间存在回路/环路，那么就会产生广播循环风暴，从而严重影响网络性能。</span></p><p><span>而交换机中运行的 STP 协议能避免交换机之间发生广播循环风暴。</span></p><p><span>只使用交换机，构建如下拓扑：</span></p><p><img src="img/3.3.png" style="zoom:60%;" /></p><p><span>这是初始时的状态。我们可以看到交换机之间有回路，这会造成广播帧循环传送即形成广播风暴，严重影响网络性能。</span></p><p><span>随后，交换机将自动通过生成树协议（STP）对多余的线路进行自动阻塞（Blocking），以形成一棵以 Switch4 为根（具体哪个是根交换机有相关的策略）的具有唯一路径树即生成树！</span></p><p><span>经过一段时间，随着 STP 协议成功构建了生成树后，Switch5 的两个接口当前物理上是连接的，但逻辑上是不通的，处于Blocking状态（桔色）如下图所示：</span></p><p><img src="img/3.4.png" style="zoom:60%;" /></p><p><span>在网络运行期间，假设某个时候 Switch4 与 Switch5 之间的物理连接出现问题（将 Switch4 与 Switch5 的连线剪掉），则该生成树将自动发生变化。Switch5 上方先前 Blocking 的那个接口现在活动了（绿色），但下方那个接口仍处于 Blocking 状态（桔色）。如下图所示：</span></p><p><img src="img/3.5.png" style="zoom:60%;" /></p><h4 id='5路由器配置初步'><span>5.路由器配置初步</span></h4><p><span>我们模拟重庆交通大学和重庆大学两个学校的连接，构建如下拓扑：</span></p><p><img src="img/4.1.png" style="zoom:60%;" /></p><p>&nbsp;</p><p>&nbsp;</p><h5 id='说明一'><span>说明一</span></h5><p><span>交通大学与重庆大学显然是两个不同的子网。在不同子网间通信需通过路由器。</span></p><p><span>路由器的每个接口下至少是一个子网，图中我们简单的规划了 3 个子网：</span></p><ol start='' ><li><span>左边路由器是交通大学的，其下使用交换机连接交通大学的网络，分配网络号 </span><code>192.168.1.0/24</code><span>，该路由器接口也是交通大学网络的网关，分配 IP 为 </span><code>192.168.1.1</code></li><li><span>右边路由器是重庆大学的，其下使用交换机连接重庆大学的网络，分配网络号 </span><code>192.168.3.0/24</code><span>，该路由器接口也是重庆大学网络的网关，分配 IP 为 </span><code>192.168.3.1</code></li><li><span>两个路由器之间使用广域网接口相连，也是一个子网，分配网络号 </span><code>192.168.2.0/24</code></li></ol><h5 id='说明二'><span>说明二</span></h5><p><span>现实中，交通大学和重庆大学的连接是远程的。该连接要么通过路由器的光纤接口，要么通过广域网接口即所谓的 </span><code>serial</code><span> 口（如拓扑图所示）进行，一般不会通过双绞线连接（为什么？）。</span></p><p><span>下面我们以通过路由器的广域网口连接为例来进行相关配置。请注意：我们选用的路由器默认没有广域网模块（名称为 </span><code>WIC-1T</code><span> 等），需要关闭路由器后添加，然后再开机启动。</span></p><h5 id='说明三'><span>说明三</span></h5><p><span>在模拟的广域网连接中需注意 DCE 和 DTE 端（连线时线路上有提示，带一个时钟标志的是 DCE 端。有关 DCE 和 DTE 的概念请查阅相关资料。），在 DCE 端需配置时钟频率 </span><code>64000</code></p><h5 id='说明四'><span>说明四</span></h5><p><span>路由器有多种命令行配置模式，每种模式对应不同的提示符及相应的权限。</span></p><p><span>请留意在正确的模式下输入配置相关的命令。</span></p><ul><li><span>User mode：用户模式</span></li><li><span>Privileged mode：特权模式</span></li><li><span>Global configuration mode：全局配置模式</span></li><li><span>Interface mode：接口配置模式</span></li><li><span>Subinterface mode：子接口配置模式</span></li></ul><h5 id='说明五'><span>说明五</span></h5><p><span>在现实中，对新的路由器，显然不能远程进行配置，我们必须在现场通过笔记本的串口与路由器的 console 接口连接并进行初次的配置（注意设置比特率为9600）后，才能通过网络远程进行配置。这也是上图左上画出笔记本连接的用意。</span></p><h5 id='说明六'><span>说明六</span></h5><p><span>在路由器的 </span><code>CLI</code><span> 界面中，可看到路由器刚启动成功后，因为无任何配置，将会提示是否进行对话配置（Would you like to enter the initial configuration dialog?），因其步骤繁多，请选择 NO</span></p><p><span>比如交通大学路由器的初步配置可以如下：</span></p><p>&nbsp;</p><p><img src="img/4.2.png" style="zoom:60%;" /></p><p><span>拓扑图中路由器各接口配置数据如下：</span></p><figure><table><thead><tr><th><strong><span>接口名</span></strong></th><th><strong><span>IP</span></strong></th><th><strong><span>子网掩码</span></strong></th></tr></thead><tbody><tr><td><span>交通大学 Router2 以太网口</span></td><td><span>192.168.1.1</span></td><td><span>255.255.255.0</span></td></tr><tr><td><span>交通大学 Router2 广域网口</span></td><td><span>192.168.2.1</span></td><td><span>255.255.255.0</span></td></tr><tr><td><span>重庆大学 Router3 以太网口</span></td><td><span>192.168.3.1</span></td><td><span>255.255.255.0</span></td></tr><tr><td><span>重庆大学 Router3 广域网口</span></td><td><span>192.168.2.2</span></td><td><span>255.255.255.0</span></td></tr></tbody></table></figure><p><span>拓扑图中各 PC 配置数据如下：</span></p><figure><table><thead><tr><th><strong><span>节点名</span></strong></th><th><strong><span>IP</span></strong></th><th><strong><span>子网掩码</span></strong></th><th><strong><span>网关</span></strong></th></tr></thead><tbody><tr><td><span>交通大学 PC0</span></td><td><span>192.168.1.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>交通大学 PC1</span></td><td><span>192.168.1.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>重庆大学 PC2</span></td><td><span>192.168.3.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.3.1</span></td></tr><tr><td><span>重庆大学 PC3</span></td><td><span>192.168.3.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.3.1</span></td></tr></tbody></table></figure><h5 id='交通大学路由器基本配置如下'><span>交通大学路由器基本配置如下：</span></h5><p><span>以太网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;enable &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#configure terminal &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#interface f0/0 &nbsp; // 进入配置以太网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 192.168.1.1 255.255.255.0 &nbsp; // 配置该接口的 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#^z &nbsp; // 直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><span>广域网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#interface s0/0 &nbsp; // 进入配置广域网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 192.168.2.1 255.255.255.0 &nbsp; //配置该接口的 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#clock rate 64000 &nbsp;  // 其为 DCE 端，配置时钟频率</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#^z &nbsp; // 直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 179px;"></div></div></div></pre><h5 id='重庆大学路由器基本配置如下'><span>重庆大学路由器基本配置如下：</span></h5><p><span>以太网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int f0/0 &nbsp; // 进入配置以太网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 192.168.3.1 255.255.255.0 &nbsp; // 配置该接口的 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#^z &nbsp; // 直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><span>广域网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int s0/0 &nbsp; // 进入配置广域网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 192.168.2.2 255.255.255.0 &nbsp; //配置该接口的 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#^z &nbsp; // 直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><span>因为2621XM不带广域网接口：</span></p><p><span>因此需要先做如下操作(关机后需要重新配置路由):</span></p><p><img src="img/6.3.png" style="zoom:67%;" /></p><p><span>最后能够连通网络:如下图所示：</span></p><p><img src="img/4.3.png" style="zoom:60%;" /></p><p><span>目前同一子网内可以Ping通，不同子网还不能够Ping通 如下图所示 </span></p><p><img src="img/4.4.png" style="zoom:60%;" /></p><p>&nbsp;</p><h5 id='问题-12'><strong><span>问题</span></strong></h5><p><span>现在交通大学内的各 PC 及网关相互能 </span><code>ping</code><span> 通，重庆大学也类似。但不能从交大的 PC </span><code>ping</code><span> 通重大的 PC，反之亦然，也即不能跨子网。为什么？</span></p><p><span>答：测试网络时，经常用的方法是Ping某个IP地址，如果能Ping通，则说明这条链路是畅通的，如Ping不通，则说明这个链路不通，这个测试方法得出的结论是不严谨的，也不一定是正确的。</span>
<span>Ping功能不像完整的TCP/IP数据包，Ping功能发送的只不过是ICMP控制报文协议包。当你使用Ping功能时，本地PC会首先查询本地的ARP地址映射表，如果目的IP不在ARP缓存中，则受限会查询ARP映射表。如果你的电路连接的是一般路由器即无没有三层交换路由功能，本地电路查询ARP映射表的时候，会发出一个MAC层目的地址为路由器MAC地址的ICMP数据包，路由器收到ICMP数据包之后，经过地址过滤，发现目的IP地址不是其路由器的子网，则会将此ICMP包抛弃，不会发出ARP查询包进行ARP地址查询。如果本地电脑连接的是有三层交互路由功能的交换机或者路由器，则其会发出ARP查询数据包进行网络查询。</span></p><h4 id='6静态路由'><span>6.静态路由</span></h4><p><span>静态路由是非自适应性路由协议，是由网络管理人员手动配置的，不能够根据网络拓扑的变化而改变。 因此，静态路由简单高效，适用于结构非常简单的网络。</span></p><p><span>在当前这个简单的拓扑结构中我们可以使用静态路由，即直接告诉路由器到某网络该怎么走即可。</span></p><p><span>在前述路由器基本配置成功的情况下使用以下命令进行静态路由协议的配置：</span></p><h5 id='交通大学路由器静态路由配置'><span>交通大学路由器静态路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#ip route 192.168.3.0 255.255.255.0 192.168.2.2 &nbsp; // 告诉交通大学路由器到 192.168.3.0 这个网络的下一跳是 192.168.2.2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#exit &nbsp; //退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#show ip route &nbsp;  //查看路由表</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 134px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><p><img src="img/6.2.png" style="zoom:60%;" /></p><h5 id='重庆大学路由器静态路由配置'><span>重庆大学路由器静态路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#ip route 192.168.1.0 255.255.255.0 192.168.2.1 &nbsp; // 告诉重庆大学路由器到 192.168.1.0 这个网络的下一跳是 192.168.2.1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#exit &nbsp; //退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#show ip route &nbsp;  //查看路由表</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 134px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><p><img src="img/6.1.png" style="zoom:60%;" /></p><p><span>查看路由表你可看到标记为 </span><code>S</code><span> 的一条路由，</span><code>S</code><span> 表示 Static 。</span></p><p><span>至此，这些 PC 能全部相互 </span><code>ping</code><span> 通！</span></p><p><img src="img/6.4.png" style="zoom:60%;" /></p><p><span>第一次丢包属于正常行为，第一次没找到。</span></p><h4 id='7动态路由-rip'><span>7.动态路由 RIP</span></h4><p><span>动态路由协议采用自适应路由算法，能够根据网络拓扑的变化而重新计算机最佳路由。</span></p><p><span>RIP 的全称是 Routing Information Protocol，是距离矢量路由的代表（目前虽然淘汰，但可作为我们学习的对象）。使用 RIP 协议只需要告诉路由器直接相连有哪些网络即可，然后 RIP 根据算法自动构建出路由表。</span></p><p><span>因为我们模拟的网络非常简单，因此不能同时使用静态和动态路由，否则看不出效果，所以我们需要把刚才配置的静态路由先清除掉。</span></p><h5 id='清除静态路由配置'><span>清除静态路由配置：</span></h5><ol start='' ><li><p><span>直接关闭路由器电源。相当于没有保存任何配置，然后各接口再按照前面基本配置所述重新配置 IP 等参数（推荐此方法，可以再熟悉一下接口的配置命令）；</span></p></li><li><p><span>使用 </span><code>no</code><span> 命令清除静态路由。在全局配置模式下，交通大学路由器使用：</span><code>no ip route 192.168.3.0 255.255.255.0 192.168.2.2</code><span>，重庆大学路由器使用：</span><code>no ip route 192.168.1.0 255.255.255.0 192.168.2.1</code><span> 。相当于使用 </span><code>no</code><span> 命令把刚才配置的静态路由命令给取消。</span></p><p><img src="img/7.2.png" style="zoom:60%;" /></p><p><img src="img/7.1.png" style="zoom:60%;" /></p></li></ol><h5 id='交通大学路由器-rip-路由配置'><span>交通大学路由器 RIP 路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#router rip &nbsp; // 启用 RIP 路由协议，注意是 router 命令</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.1.0 &nbsp; // 网络 192.168.1.0 与我直连</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.2.0 &nbsp; // 网络 192.168.2.0 与我直连</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#^z &nbsp; //直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#show ip route &nbsp;  //查看路由表</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><img src="img/7.3.png" style="zoom:60%;" /></p><h5 id='重庆大学路由器-rip-路由配置'><span>重庆大学路由器 RIP 路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#router rip &nbsp; // 启用RIP路由协议，注意是 router 命令</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.3.0 &nbsp; // 网络 192.168.3.0 与我直连</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.2.0 &nbsp; // 网络 192.168.2.0 与我直连</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#^z &nbsp; //直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#show ip route &nbsp;  //查看路由表</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><img src="img/7.4.png" style="zoom:60%;" /></p><p><span>查看路由表你可看到标记为 </span><code>R</code><span> 的一条路由，</span><code>R</code><span> 表示 RIP 。</span></p><p><span>至此，这些 PC 也能全部相互 </span><code>ping</code><span> 通！</span></p><p><img src="img/7.5.png" style="zoom:60%;" /><span>‘</span></p><p><img src="img/7.6.png" style="zoom:60%;" /></p><h4 id='8动态路由-ospf'><span>8.动态路由 OSPF</span></h4><p><span>OSPF（Open Shortest Path First 开放式最短路径优先）是一个内部网关协议（Interior Gateway Protocol，简称 IGP）， 用于在单一自治系统（Autonomous System，AS）内决策路由。OSPF 性能优于 RIP，是当前域内路由广泛使用的路由协议。</span></p><p><span>同样的，我们需要把刚才配置的 RIP 路由先清除掉。</span></p><h5 id='清除-rip-路由配置'><span>清除 RIP 路由配置：</span></h5><ol start='' ><li><p><span>直接关闭路由器电源。相当于没有保存任何配置，然后各接口再按照前面基本配置所述重新配置 IP 等参数</span></p></li><li><p><span>使用 </span><code>no</code><span> 命令清除 RIP 路由。在全局配置模式下，各路由器都使用：</span><code>no router rip</code><span> 命令进行清除</span></p><p><img src="img/8.1.png" style="zoom:60%;" /></p><p><img src="img/8.2.png" style="zoom:60%;" /></p></li></ol><h5 id='交通大学路由器-ospf-路由配置-1'><span>交通大学路由器 OSPF 路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#router ospf 1 &nbsp; // 启用 OSPF 路由协议，进程号为1（可暂不理会进程号概念）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.1.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于 192.168.1.0/24 网络的所有主机（反向掩码）参与 OSPF</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.2.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于 192.168.2.0/24 网络的所有主机（反向掩码）参与 OSPF</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#^z &nbsp; //直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#show ip route &nbsp;  //查看路由表</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 202px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></pre><p><img src="img/8.3.png" style="zoom:60%;" /></p><h5 id='重庆大学路由器-ospf-路由配置-1'><span>重庆大学路由器 OSPF 路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#router ospf 1 &nbsp; // 启用 OSPF 路由协议，进程号为1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.3.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于 192.168.3.0/24 网络的所有主机（反向掩码）参与 OSPF</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.2.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于 192.168.2.0/24 网络的所有主机（反向掩码）参与 OSPF</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#^z &nbsp; //直接退到特权模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#show ip route &nbsp;  //查看路由表</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 202px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></pre><p><img src="img/8.4.png" style="zoom:60%;" /></p><p><span>查看路由表你可看到标记为 O 的一条路由，O 表示 OSPF 。</span></p><p><span>至此，这些 PC 能全部相互 </span><code>ping</code><span> 通！</span></p><p><img src="img/8.5.png" style="zoom:60%;" /></p><h5 id='反向掩码'><strong><span>反向掩码</span></strong></h5><p><span>我们常见的子网掩码是所谓的正向掩码，用连续的 </span><code>1</code><span> 和 </span><code>0</code><span> 来表示，其中 </span><code>1</code><span> 表示需精确匹配， </span><code>0</code><span> 则无需，以此得到网络号。</span></p><p><span>类似的，反向掩码也使用连续的 </span><code>1</code><span> 和 </span><code>0</code><span> 来表示，但相反，其中 </span><code>0</code><span> 表示需精确匹配， </span><code>1</code><span> 则无需，以此得到相关的 IP，主要用于 OSPF 中。</span></p><p><span>还有一个通配符掩码，也采用与反向掩码相似的规则，主要用于访问控制列表 ACL 中。</span></p><p><span>用途：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">掩码主要用于IP地址配置时候使用</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">反掩码主要用于动态路由协议通告的时候使用</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">通配符主要用于ACL配置时候使用 </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 112px;"></div></div></div></pre><h4 id='9基于端口的网络地址翻译-pat'><span>9.基于端口的网络地址翻译 PAT</span></h4><p><span>网络地址转换（NAT，Network Address Translation）被各个 Internet 服务商即 ISP 广泛应用于它们的网络中，也包括 WiFi 网络。 原因很简单，NAT 不仅完美地解决了 lP 地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。</span></p><p><span>NAT 的实现方式一般有三种：</span></p><ul><li><span>静态转换： Static NAT</span></li><li><span>动态转换： Dynamic NAT</span></li><li><span>端口多路复用： OverLoad</span></li></ul><p><span>端口多路复用使用最多也最灵活。OverLoad 是指不仅改变发向 Internet 数据包的源 IP 地址，同时还改变其源端口，即进行了端口地址转换（PAT，Port Address Translation）。</span></p><p><span>采用端口多路复用方式，内部网络的所有主机均可共享一个合法外部 IP 地址实现对 Internet 的访问，从而可以最大限度地节约IP地址资源。 同时，又可隐藏网络内部的所有主机，有效避免来自 Internet 的攻击。因此，目前网络中应用最多的就是端口多路复用方式。</span></p><p><span>我们仍然使用重庆交通大学和重庆大学两个学校的拓扑进行 PAT 实验。我们需要保证两个学校的路由已经配置成功，无论使用静态路由还是动态路由，以下我们给出完整的配置过程：设定这两个学校的路由器使用 OSPF 协议，模拟交通大学使用内部 IP 地址（</span><code>192.168.1.0/24</code><span>），模拟重庆大学使用外部 IP 地址（</span><code>8.8.8.0/24</code><span>），两个路由器之间使用外部 IP 地址（</span><code>202.202.240.0/24</code><span>），在交通大学的出口位置即广域网口实施 PAT。</span></p><p><span>拓扑图中各 PC 配置数据如下：</span></p><figure><table><thead><tr><th><strong><span>节点名</span></strong></th><th><strong><span>IP</span></strong></th><th><strong><span>子网掩码</span></strong></th><th><strong><span>网关</span></strong></th></tr></thead><tbody><tr><td><span>交通大学 PC0</span></td><td><span>192.168.1.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>交通大学 PC1</span></td><td><span>192.168.1.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>重庆大学 PC2</span></td><td><span>8.8.8.2</span></td><td><span>255.255.255.0</span></td><td><span>8.8.8.1</span></td></tr><tr><td><span>重庆大学 PC3</span></td><td><span>8.8.8.3</span></td><td><span>255.255.255.0</span></td><td><span>8.8.8.1</span></td></tr></tbody></table></figure><p><span>🗣 请留意重庆大学两个 PC 的网络配置发生改变，我们模拟为外部/公网 IP 地址！</span></p><p><span>拓扑图中路由器各接口配置数据如下：</span></p><figure><table><thead><tr><th><strong><span>接口名</span></strong></th><th><strong><span>IP</span></strong></th><th><strong><span>子网掩码</span></strong></th></tr></thead><tbody><tr><td><span>交通大学 Router2 以太网口</span></td><td><span>192.168.1.1</span></td><td><span>255.255.255.0</span></td></tr><tr><td><span>交通大学 Router2 广域网口</span></td><td><span>202.202.240.1</span></td><td><span>255.255.255.0</span></td></tr><tr><td><span>重庆大学 Router3 以太网口</span></td><td><span>8.8.8.1</span></td><td><span>255.255.255.0</span></td></tr><tr><td><span>重庆大学 Router3 广域网口</span></td><td><span>202.202.240.2</span></td><td><span>255.255.255.0</span></td></tr></tbody></table></figure><p><span>🗣 请留意重庆大学路由器两个接口及交通大学广域网口的网络配置发生改变，然后配置 OSPF 路由，最后在交通大学路由器的广域网口实施 PAT！</span></p><h5 id='交通大学路由器接口配置如下'><span>交通大学路由器接口配置如下：</span></h5><p><span>以太网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int f0/0 &nbsp; // 进入配置以太网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 192.168.1.1 255.255.255.0 &nbsp; // 配置 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 112px;"></div></div></div></pre><p><span>广域网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int s0/0 &nbsp; // 进入配置广域网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 202.202.240.1 255.255.255.0 &nbsp; //配置 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#clock rate 64000 &nbsp;  // 其为 DCE 端，配置时钟频率</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 134px;"></div><div class="CodeMirror-gutters" style="display: none; height: 134px;"></div></div></div></pre><h5 id='重庆大学路由器接口配置如下'><span>重庆大学路由器接口配置如下：</span></h5><p><span>以太网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int f0/0 &nbsp; // 进入配置以太网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 8.8.8.1 255.255.255.0 &nbsp; // 配置 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 112px;"></div></div></div></pre><p><span>广域网口：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int s0/0 &nbsp; // 进入配置广域网口模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip address 202.202.240.2 255.255.255.0 &nbsp; // 配置 IP</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#no shutdown &nbsp; // 激活接口</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 112px;"></div></div></div></pre><h5 id='交通大学路由器-ospf-路由配置-2'><span>交通大学路由器 OSPF 路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#router ospf 1 &nbsp; // 启用 OSPF 路由协议，进程号为1（可暂不理会进程号概念）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 192.168.1.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于192.168.1.0/24网络的所有主机（反向掩码）参与 OSPF</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 202.202.240.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于202.202.240.0/24网络的所有主机（反向掩码）参与 OSPF</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><h5 id='重庆大学路由器-ospf-路由配置-2'><span>重庆大学路由器 OSPF 路由配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#router ospf 1 &nbsp; // 启用 OSPF 路由协议，进程号为1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 202.202.240.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于202.202.240.0/24网络的所有主机（反向掩码）参与 OSPF</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-router)#network 8.8.8.0 0.0.0.255 area 0 &nbsp; // 自治域0中的属于8.8.8.0/24网络的所有主机（反向掩码）参与 OSPF</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><img src="img/9.1.png" style="zoom:60%;" /></p><p><img src="img/9.2.png" style="zoom:60%;" /></p><p><span>此时，这些 PC 能全部相互 </span><code>ping</code><span> 通！如在交通大学内部使用 PC0（</span><code>192.168.1.2</code><span>）来 </span><code>ping</code><span> 重庆大学的PC2（</span><code>8.8.8.2</code><span>）应该成功。</span></p><p><img src="img/9.3.png" style="zoom:60%;" /></p><p><span>下面我们将重庆大学的路由器看着 Internet 中的骨干路由器，那么这些路由器将不会转发内部/私有 IP 地址的包（直接丢弃）。我们通过在重庆大学路由器上实施访问控制 ACL ，即丢弃来自交通大学（私有 IP 地址）的包来模拟这个丢包的过程。</span></p><h5 id='重庆大学路由器丢包的配置'><span>重庆大学路由器丢包的配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#access-list 1 deny 192.168.1.0 0.0.0.255  // 创建 ACL 1，丢弃/不转发来自 192.168.1.0/24 网络的所有包</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#access-list 1 permit any  // 添加 ACL 1 的规则，转发其它所有网络的包</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int s0/0 &nbsp; // 配置广域网口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip access-group 1 in  // 在广域网口上对进来的包实施 ACL 1 中的规则，实际就是广域网口如果收到来自 192.168.1.0/24 IP的包即丢弃</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 179px;"></div></div></div></pre><p><span>此时，再使用交通大学内部的 PC0（</span><code>192.168.1.2</code><span>）来 </span><code>ping</code><span> 重庆大学的 PC2（</span><code>8.8.8.2</code><span>）就不成功了，会显示目的主机不可到达（</span><code>Destination host unreachable</code><span>）信息。</span></p><p><img src="img/9.4.png" style="zoom:60%;" /></p><p><img src="img/9.5.png" style="zoom:60%;" /></p><p><code>ping</code><span> 的同时，在 CPT 软件中使用模拟（</span><code>Simulation</code><span>）方式会看得非常清楚：重庆大学路由器的广域网口将来自交通大学的包丢弃了！</span></p><p><span>下面，我们就开始实施 PAT。即：我们将会在交通大学路由器的出口上将内部/私有 IP 地址转换为外部/公开 IP，从而包的源 IP 发生了改变，就不会被重庆大学路由器丢弃，因此网络连通。</span></p><h5 id='交通大学路由器-pat-配置'><span>交通大学路由器 PAT 配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router&gt;en &nbsp; // 从普通模式进入特权模式</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router#conf t &nbsp; // 进入全局配置模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#access-list 1 permit 192.168.1.0 0.0.0.255  // 创建 ACL 1，允许来自 192.168.1.0/24 网络的所有包</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#ip nat inside source list 1 interface s0/0 overload  // 来自于 ACL 中的 IP 将在广域网口实施 PAT</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int f0/0 &nbsp; // 配置以太网口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip nat inside &nbsp; // 配置以太网口为 PAT 的内部</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config)#int s0/0 &nbsp; // 配置广域网口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Router(config-if)#ip nat outside &nbsp; // 配置广域网口为 PAT 的外部</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 179px;"></div></div></div></pre><p><img src="img/9.6.png" style="zoom:60%;" /></p><p><img src="img/9.8.png" referrerpolicy="no-referrer"></p><p><span>现在，再次使用交通大学内部的 PC0（</span><code>192.168.1.2</code><span>）来 </span><code>ping</code><span> 重庆大学的PC2（</span><code>8.8.8.2</code><span>）则OK。</span></p><p><img src="img/9.7.png" style="zoom:60%;" /></p><h4 id='10虚拟局域网-vlan'><span>10.虚拟局域网 VLAN</span></h4><p><span>在实际网络中，你可看到路由器一般位于网络的边界，而内部几乎全部使用交换机连接。</span></p><p><span>前面我们分析过，交换机连接的是同一个子网！ 显然，在这样一个大型规模的子网中进行广播甚至产生广播风暴将严重影响网络性能甚至瘫痪。</span></p><p><span>另外我们也已经知道，其实学校是划分了 N 多个子网的，那么这些交换机连接的就绝不是一个子网！这样矛盾的事情该如何解释呢？我们实际上使用了支持 VLAN 的交换机！而前述的交换机只是普通的 2 层交换机（或者我们把它当作 2 层交换机在使用。</span></p><p><span>VLAN（Virtual Local Area Network）即虚拟局域网。通过划分 VLAN，我们可以把一个物理网络划分为多个逻辑网段即多个子网。</span></p><p><span>划分 VLAN 后可以杜绝网络广播风暴，增强网络的安全性，便于进行统一管理等。</span></p><p><span>在 CPT 中构建如下图所示拓扑：</span></p><p><img src="img/10.2.png" style="zoom:80%;" /></p><p><span>Cisco 2960 交换机是支持 VLAN 的交换机，共有 24 个 100M 和 2 个 1000M 以太网口。默认所有的接口都在 </span><code>VLAN 1</code><span>中，故此时连接上来的计算机都处于同一 VLAN，可以进行通信。</span></p><p><span>下面我们就该交换机的 24 个 100M 接口分为 3 个部分，划分到 3 个不同的 VLAN 中，id 号分别设为 10、20、30，且设置别名（computer、communication、electronic）以利于区分和管理。</span></p><h5 id='交换机-vlan-配置'><span>交换机 VLAN 配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch&gt;en</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch#conf t</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#vlan 10 &nbsp;  // 创建 id 为 10 的 VLAN（缺省的，交换机所有接口都属于VLAN 1，不能使用）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-vlan)#name computer &nbsp;  // 设置 VLAN 的别名</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-vlan)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#int vlan 10 &nbsp;  // 该 VLAN 为一个子网，设置其 IP，作为该子网网关</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if)#ip address 192.168.0.1 255.255.255.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#vlan 20 &nbsp;  // 创建 id 为 20 的 VLAN</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-vlan)#name communication &nbsp;  //设置别名</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-vlan)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#int vlan 20</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if)#ip addr 192.168.1.1 255.255.255.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#vlan 30 &nbsp;  // 创建 id 为 20 的 VLAN</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-vlan)#name electronic &nbsp;  // 设置别名</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-vlan)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#int vlan 30</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if)#ip add 192.168.2.1 255.255.255.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#int range f0/1-8 &nbsp;  // 成组配置接口（1-8）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#switchport mode access &nbsp;  // 设置为存取模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#switchport access vlan 10 &nbsp;  // 划归到 VLAN 10 中</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#int range f0/9-16</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#switchport mode access</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#switchport access vlan 20</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#int range f0/17-24</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#switchport mode access</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#switchport access vlan 30</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config-if-range)#^Z</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch#show vlan // 查看 VLAN 的划分情况</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 739px;"></div><div class="CodeMirror-gutters" style="display: none; height: 739px;"></div></div></div></pre><p><img src="img/10.1.png" style="zoom:67%;" /></p><p><span>至此，在该交换机上我们就划分了 3 个 VLAN（不包括缺省的 VLAN 1）。</span></p><p><span>各 VLAN 下 PC 的网络配置及连接的交换机接口如下表：</span></p><figure><table><thead><tr><th><strong><span>机器名</span></strong></th><th><strong><span>连接的接口</span></strong></th><th><strong><span>所属VLAN</span></strong></th><th><strong><span>IP</span></strong></th><th><strong><span>子网掩码</span></strong></th><th><strong><span>网关</span></strong></th></tr></thead><tbody><tr><td><span>PC0</span></td><td><span>F0/1</span></td><td><span>VLAN 10</span></td><td><span>192.168.0.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.0.1</span></td></tr><tr><td><span>PC1</span></td><td><span>F0/2</span></td><td><span>VLAN 10</span></td><td><span>192.168.0.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.0.1</span></td></tr><tr><td><span>PC2</span></td><td><span>F0/17</span></td><td><span>VLAN 30</span></td><td><span>192.168.2.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.2.1</span></td></tr><tr><td><span>PC3</span></td><td><span>F0/9</span></td><td><span>VLAN 20</span></td><td><span>192.168.1.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>PC4</span></td><td><span>F0/10</span></td><td><span>VLAN 20</span></td><td><span>192.168.1.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>PC5</span></td><td><span>F0/18</span></td><td><span>VLAN 30</span></td><td><span>192.168.2.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.2.1</span></td></tr><tr><td><span>PC6</span></td><td><span>F0/19</span></td><td><span>VLAN 30</span></td><td><span>192.168.2.4</span></td><td><span>255.255.255.0</span></td><td><span>192.168.2.1</span></td></tr></tbody></table></figure><p><span>此时可以使用 </span><code>ping</code><span> 命令进行测试，你会发现只有在同一 VLAN 中的 PC 才能通信，且广播也局限于该 VLAN。</span></p><p><span>网络测试，ping同一VLAN下可以ping通</span></p><p><span>ping不同VLAN下ping不通</span></p><p><img src="img/10.3.png" style="zoom:80%;" /></p><p><img src="img/10.4.png" style="zoom:80%;" /></p><h5 id='✎-思考'><span>✎ </span><strong><span>思考</span></strong></h5><p><span>分析一下当前为何不同 VLAN 中的 PC 不能通信？网关在此起什么作用？我们的网关又在何处？如何发起广播测试？</span></p><p><span>答：</span>
<span>1、VLAN具有分割网络的作用，因此不能通信</span>
<span>2、VLAN只是链路层协议，划分广播域，而不需要考虑IP；网关是用来进行协议转换的。不同的网段之间需要通信一定需要网关。</span>
<span>3、若是要发起广播测试，那么就要引入三层设备</span></p><h4 id='11虚拟局域网管理-vtp'><span>11.虚拟局域网管理 VTP</span></h4><p><span>前一个实验我们在交换机上进行了 VLAN 的规划和划分。但在实际应用中，我们绝不允许在这些支持VLAN的交换机上进行随意的 VLAN 划分，如此将造成管理混乱！VLAN的划分必须得到统一的规划和管理，这就需要 VTP 协议。</span></p><p><span>VTP（VLAN Trunk Protocol）即 VLAN 中继协议。VTP 通过 ISL 帧或 Cisco 私有 DTP 帧（可查阅相关资料了解）保持 VLAN 配置统一性，也被称为虚拟局域网干道协议，它是思科私有协议。 VTP 统一管理、增加、删除、调整VLAN，自动地将信息向网络中其它的交换机广播。</span></p><p><span>此外，VTP 减小了那些可能导致安全问题的配置，只要在 VTP Server 做相应设置，VTP Client 会自动学习 VTP Server 上的 VLAN 信息。</span></p><p><span>为演示 VTP，重新构建如下拓扑结构：</span></p><p><img src="img/2.1.png" style="zoom:80%;" /></p><p><span>🗣 注意：</span></p><p><span>作为干线，两个 2960 交换机和核心的 3560 交换机应该使用 Gbit 口相连。这虽然不是必须，但现实中这样连接性能最好。</span></p><p><span>3560 交换机是网络中的核心交换机，我们将其作为 VTP Server，VTP 域及 VLAN 将在其上创建和管理。</span></p><p><span>两个 2960 交换机是是局域网中的汇聚层/接入层交换机，将作为 VTP Client，可决定加入的 VTP 域和 VLAN。</span></p><p><span>目前该网络都属于 </span><code>VLAN 1</code><span>，也即这些 PC 是可以相互通信的。前面说过，无论对于性能、管理还是安全等而言，现实中我们必须进行 VLAN 划分。</span></p><p><span>现在我们的要求是：新建两个 VLAN，然后让 PC0 和 PC2 属于 </span><code>VLAN 2</code><span>，PC1 和 PC3 属于 </span><code>VLAN 3</code><span>。</span></p><p><span>我们将在核心交换机 3560上进行如下工作：</span></p><ol start='' ><li><span>设置为 </span><code>server</code><span> 模式，VTP 域为 </span><code>cqjtu</code></li><li><span>新建 </span><code>VLAN 2</code><span>，网络号 </span><code>192.168.1.0/24</code><span>，网关 </span><code>192.168.1.1</code></li><li><span>新建 </span><code>VLAN 3</code><span>，网络号 </span><code>192.168.2.0/24</code><span>，网关 </span><code>192.168.2.1</code></li></ol><h5 id='3560-vtp-server-配置'><span>3560 VTP Server 配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch&gt;en</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch#conf t</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#hostname 3560 &nbsp;  // 更改交换机名称（可选）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#vtp domain cqjtu &nbsp; // 设置 VTP 域名称为 cqjtu</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#vtp mode server &nbsp;  // 设置其为 VTP 服务器模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#vlan 2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 新建VLAN 2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-vlan)#name computer // 设置 VLAN 2 的别名（可选）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-vlan)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#vlan 3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 再建 VLAN 3</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-vlan)#name communication &nbsp;  //设置 VLAN 2 的别名（可选）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-vlan)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#int vlan 2 &nbsp;  // 配置接口 VLAN 2，它将是该子网（左边）的网关</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#ip address 192.168.1.1 255.255.255.0</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#int vlan 3 &nbsp;  // 配置接口 VLAN 3，它将是该子网（右边）的网关</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#ip address 192.168.2.1 255.255.255.0</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 358px;"></div><div class="CodeMirror-gutters" style="display: none; height: 358px;"></div></div></div></pre><p><span>我们将在左边交换机 2960A 上进行如下工作：</span></p><ol start='' ><li><span>加入名为 </span><code>cqjtu</code><span> 的 VTP 域</span></li><li><span>配置与核心交换机 3560 连接的千兆接口 </span><code>g0/1</code><span> 为 </span><code>trunk</code><span> 模式</span></li><li><span>将接口 </span><code>f0/1</code><span> 划分到 </span><code>VLAN 2</code><span> 中</span></li><li><span>将接口 </span><code>f0/2</code><span> 划分到 </span><code>VLAN 3</code><span> 中</span></li></ol><h5 id='2960a左边）-vtp-client-配置'><span>2960A（左边） VTP Client 配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch&gt;en</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch#conf t</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#hostname 2960A &nbsp;  // 更改交换机名称（可选）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config)#vtp domain cqjtu &nbsp; // 加入名为 cqjtu 的 VTP 域</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config)#vtp mode client &nbsp;  // 设置模式为 VTP 客户</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config)#int g0/1 &nbsp;  // 配置与核心交换机 3560 连接的 g0/1 千兆接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#switchport mode trunk &nbsp;  // 设置该接口为中继（trunk）模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#switchport trunk allowed vlan all  // 允许为所有的 VLAN 中继</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config)#int f0/1 &nbsp;  // 配置接口 1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#switchport mode access &nbsp;  // 设置该接口为正常访问模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#switchport access vlan 2  // 将接口划分到 VLAN 2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config)#int f0/2 &nbsp;  // 配置接口 2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#switchport mode access &nbsp;  // 设置该接口为正常访问模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960A(config-if)#switchport access vlan 3  // 将接口划分到 VLAN 3</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 358px;"></div><div class="CodeMirror-gutters" style="display: none; height: 358px;"></div></div></div></pre><p><span>我们将在右边交换机 2960B 上进行同样的工作：</span></p><ol start='' ><li><span>加入名为 </span><code>cqjtu</code><span> VTP 域</span></li><li><span>配置与核心交换机 3560 连接的千兆接口 </span><code>g0/1</code><span> 为 </span><code>trunk</code><span> 模式</span></li><li><span>将接口 </span><code>f0/1</code><span> 划分到 </span><code>VLAN 2</code><span> 中</span></li><li><span>将接口 </span><code>f0/2</code><span> 划分到 </span><code>VLAN 3</code><span> 中</span></li></ol><h5 id='2960b右边）-vtp-client-配置'><span>2960B（右边） VTP Client 配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch&gt;en</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch#conf t</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Switch(config)#hostname 2960B &nbsp;  // 更改交换机名称（可选）</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config)#vtp domain cqjtu &nbsp; // 加入名为 cqjtu 的 VTP 域</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config)#vtp mode client &nbsp;  // 设置模式为 VTP 客户</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config)#int g0/1 &nbsp;  // 配置与核心交换机 3560 连接的 g0/1 千兆接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#switchport mode trunk &nbsp;  // 设置该接口为中继（trunk）模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#switchport trunk allowed vlan all  // 允许为所有的 VLAN 中继</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config)#int f0/1 &nbsp;  // 配置接口 1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#switchport mode access &nbsp;  // 设置该接口为正常访问模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#switchport access vlan 2  // 将接口划分到 VLAN 2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config)#int f0/2 &nbsp;  // 配置接口 2</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#switchport mode access &nbsp;  // 设置该接口为正常访问模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">2960B(config-if)#switchport access vlan 3  // 将接口划分到 VLAN 3</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 358px;"></div><div class="CodeMirror-gutters" style="display: none; height: 358px;"></div></div></div></pre><p><span>至此，各交换机配置完毕。</span></p><p><span>📬 秘籍</span></p><p><span>此时在 3 个交换机的特权模式下，都可使用</span><code>show vtp status</code><span>命令查看 VTP 状态，使用</span><code>show vlan</code><span>命令查看 VLAN 状态</span></p><p><img src="img/11.1.png" style="zoom:80%;" /></p><p><img src="img/11.2.png" style="zoom:80%;" /></p><p><img src="img/11.3.png" style="zoom:80%;" /></p><p><span>各 PC 连接的交换机和接口以及网络配置如下：</span></p><figure><table><thead><tr><th><strong><span>机器名</span></strong></th><th><strong><span>连接的交换机和接口</span></strong></th><th><strong><span>所属VLAN</span></strong></th><th><strong><span>IP</span></strong></th><th><strong><span>子网掩码</span></strong></th><th><strong><span>网关</span></strong></th></tr></thead><tbody><tr><td><span>PC0</span></td><td><span>2960A-F0/1</span></td><td><span>VLAN 2</span></td><td><span>192.168.1.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>PC1</span></td><td><span>2960A-F0/2</span></td><td><span>VLAN 3</span></td><td><span>192.168.2.2</span></td><td><span>255.255.255.0</span></td><td><span>192.168.2.1</span></td></tr><tr><td><span>PC2</span></td><td><span>2960B-F0/1</span></td><td><span>VLAN 2</span></td><td><span>192.168.1.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.1.1</span></td></tr><tr><td><span>PC3</span></td><td><span>2960B-F0/2</span></td><td><span>VLAN 3</span></td><td><span>192.168.2.3</span></td><td><span>255.255.255.0</span></td><td><span>192.168.2.1</span></td></tr></tbody></table></figure><p><span>至此，VTP 配置完成。同 VLAN 可以 </span><code>ping</code><span> 通，而不同 VLAN 不行（即使在同一交换机下，如从 PC0 到 PC1），且能够方便的统一规划和管理。</span></p><p><img src="img/11.4.png" style="zoom:80%;" /></p><h5 id='✎-试一试-1'><span>✎ </span><strong><span>试一试</span></strong></h5><p><span>使用 PC0（</span><code>192.168.1.2</code><span>） </span><code>ping</code><span> PC1（</span><code>192.168.2.2</code><span>） 的结果如何？使用 PC0 </span><code>ping</code><span> PC2 的结果如何？想想为什么？</span></p><p><img src="img/11.4.png" style="zoom:80%;" /></p><p><span>答：</span>
<span>1、VLAN具有分割网络的作用，因此只有属于同一个VLAN的可以通信,PC0 和 PC1属于不同VLAN，因此被隔离 而PC0和PC2属于同一VLAN。</span></p><h4 id='12vlan-间的通信'><span>12.VLAN 间的通信</span></h4><p><span>VTP 只是给我们划分和管理 VLAN 提供了方便，由上面的测试得知，目前我们仍然不能在 VLAN 间通信。</span></p><p><span>因为默认的，VLAN 间是不允许进行通信，此时我们需要所谓的独臂路由器在 VLAN 间为其进行转发！</span></p><p><span>我们使用的核心交换机 3560 是个 3 层交换机，可工作在网络层，也称路由交换机，即具有路由功能，能进行这种转发操作。</span></p><h5 id='3560-交换机配置'><span>3560 交换机配置：</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.2px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560&gt;en</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560#conf t</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#int g0/1 &nbsp;  // 配置连接左边 2960A 交换机的接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#switchport trunk encapsulation dot1q &nbsp;  // 封装 VLAN 协议</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#switchport mode trunk &nbsp; &nbsp; // 设置为中继模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#switchport trunk allowed vlan all &nbsp; &nbsp; // 在所有 VLAN 间转发</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#int g0/2 &nbsp;  // 配置连接右边 2960B 交换机的接口</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#switchport trunk encapsulation dot1q &nbsp;  //封装 VLAN 协议</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#switchport mode trunk &nbsp; &nbsp; // 设置为中继模式</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#switchport trunk allowed vlan all &nbsp; &nbsp; // 在所有 VLAN 间转发</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config-if)#exit</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">3560(config)#ip routing &nbsp;  // 启用路由转发功能</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 291px;"></div><div class="CodeMirror-gutters" style="display: none; height: 291px;"></div></div></div></pre><p><span>至此，各 VLAN 中的 PC 可以正常通信。</span></p><h5 id='✎-试一试-2'><span>✎ </span><strong><span>试一试</span></strong></h5><p><span>现在再使用 PC0（</span><code>192.168.1.2</code><span>） </span><code>ping</code><span> PC1（</span><code>192.168.2.2</code><span>） 的结果如何？使用 PC0 </span><code>ping</code><span> PC2 的结果如何？</span></p><p><img src="img/12.1.png" style="zoom:80%;" /></p><p><span>🗣 </span><strong><span>独臂路由的缺陷</span></strong></p><p><span>当使用 CPT 的模拟方式进行上面的测试时（ PC0 </span><code>ping</code><span> PC1），你会非常清楚的看到 ICMP 包全部都由 3560 交换机在转发，非常容易形成瓶颈。</span></p><p><span>现实中，我们一般不使用这种方式，而是真正使用其三层转发功能，即&quot;一次路由多次交换&quot;，请查阅相关资料。</span></p><p><img src="img/12.2.png" style="zoom:67%;" /></p><p><span>补充：一次路由多次转发指的是三层交换机。</span>
<span>举例：A点与B点通信，中间有一台三层交换机的设备。</span>
<span>A向B发数据：</span>
<span>A知道的IP地址，PC机自己检测子网掩码取得网络号看是否与自己网络同一网段，</span>
<span>如果是同一网段，A就会发出ARP的请求，B收到请求回给A一个MAC地址，然后A就会封装把数据交给三层交换机，三层交换机收到数据包，拆开封装，启用二层交换模块，查看MAC地址表对应的接口，</span>
<span>将数据包转发。</span>
<span>如果不是同一网段，A就会把数据包交给网关，这个网关正好是三层交换机配置</span>
<span>的VLAN里面的IP地址，三层交换机收到数据包，拆开封装，</span>
<span>启用三层路由模块，查看路由表对应的接口，将数据包转发</span></p><p><span>数据通过一定的识别触发机制，确立主机A与B的MAC地址及转发端口的对应关系，并记录进流缓存条目表，以后的A到B的数据，就直接交由二层交换模块完成。这就通常所说的一次路由多次转发。</span></p><h4 id='13dhcpdns及web服务器简单配置'><span>13.DHCP、DNS及Web服务器简单配置</span></h4><p><span>动态主机配置 DHCP、域名解析 DNS 以及 Web 服务在日常应用中作用巨大，我们构建如下简单的拓扑来进行练习。</span></p><p><img src="img/13.1.png" style="zoom:80%;" /></p><p><span>该拓扑中，服务器及客户机都连在同一交换机上。为简单起见，服务器 Server-PT 同时作为 DHCP、DNS 以及 Web 服务器，各客户机无需配置，将自动获取网络配置。</span></p><p><span>点击 CPT 拓扑图中的 Server 图标，设置其静态 IP 地址为 </span><code>19.89.6.4/24</code><span>，然后选择 </span><code>Service</code><span> 进行如下相关配置：</span></p><figure><table><thead><tr><th><strong><span>机器名</span></strong></th><th><strong><span>配置项目</span></strong></th><th><strong><span>说明</span></strong></th></tr></thead><tbody><tr><td><span>Server</span></td><td><span>HTTP</span></td><td><span>开启即可</span></td></tr><tr><td><span>Server</span></td><td><span>DNS</span></td><td><span>19.89.6.4：</span><a href='http://www.google.com' target='_blank' class='url'>www.google.com</a><span>、</span><a href='http://www.baidu.com' target='_blank' class='url'>www.baidu.com</a></td></tr><tr><td><span>Server</span></td><td><span>DHCP</span></td><td><span>地址池开始地址：19.89.6.10/24，并返回DNS地址</span></td></tr><tr><td><span>PC</span></td><td><span>网络配置</span></td><td><span>自动获取</span></td></tr></tbody></table></figure><h5 id='✎-试一试-3'><span>✎ </span><strong><span>试一试</span></strong></h5><ol start='' ><li><p><span>先查看各 PC，看看是否获得网络配置</span></p><p><img src="img/13.3.png" style="zoom:80%;" /></p></li><li><p><span>因为我们在 DNS 服务器中把谷歌和百度的 IP 都设为了 </span><code>19.89.6.4</code><span>，即 Server-PT，所以，如果打开 PC0 的浏览器，输入 </span><code>www.google.com</code><span> 或者 </span><code>www.baidu.com</code><span>，我们都应该看到默认的 Server-PT 这个 Web 服务器的主页（你也可进行编辑）</span></p><p><img src="img/13.2.png" style="zoom:67%;" /></p></li></ol><h4 id='14wlan初步配置'><span>14.WLAN初步配置</span></h4><p><span>WLAN 即 WiFi 当前也是广泛的应用在各种场景。</span></p><p><span>我们通过构建如下拓扑的一个家庭 WLAN 来练习一下其相关的配置：</span></p><p><img src="img/14.1.png" style="zoom:80%;" /></p><h5 id='📬-秘籍'><span>📬 秘籍</span></h5><p><span> 笔记本及台式机默认只有有线网卡，请先关机，在关机状态下删除有线网卡，添加无线网卡，然后再开机。</span></p><p><span>一般地，我们需要配置无线路由器的基本网络配置（IP、掩码、网关、DNS 等，现实中多为自动获取），然后再配置无线路由器的无线访问部分如连接密码及加密类型等，并开启 DHCP 功能等。有关配置请参考相关资料。</span></p><p>&nbsp;</p></div></div>
</body>
</html>